ðŸ“¦
160 /agent/index.js.map
41 /agent/index.js
1091 /agent/constants.js.map
2426 /agent/constants.js
170 /agent/include.js.map
67 /agent/include.js
4220 /agent/logger.js.map
3274 /agent/logger.js
2400 /agent/plugin/breaker/breaker.js.map
1425 /agent/plugin/breaker/breaker.js
173 /agent/plugin/breaker/include.js.map
21 /agent/plugin/breaker/include.js
24357 /agent/plugin/cipher/cipher.js.map
20464 /agent/plugin/cipher/cipher.js
182 /agent/plugin/foundation/include.js.map
41 /agent/plugin/foundation/include.js
292 /agent/plugin/foundation/nsbundle.js.map
110 /agent/plugin/foundation/nsbundle.js
692 /agent/plugin/foundation/nslog.js.map
320 /agent/plugin/foundation/nslog.js
1484 /agent/plugin/hooks/NSOperationQueue.js.map
1205 /agent/plugin/hooks/NSOperationQueue.js
757 /agent/plugin/hooks/UILabel.js.map
379 /agent/plugin/hooks/UILabel.js
3842 /agent/plugin/hooks/dyld.js.map
3412 /agent/plugin/hooks/dyld.js
189 /agent/plugin/hooks/include.js.map
90 /agent/plugin/hooks/include.js
777 /agent/plugin/hooks/libdyld.js.map
360 /agent/plugin/hooks/libdyld.js
207 /agent/plugin/include.js.map
229 /agent/plugin/include.js
516 /agent/plugin/jailbreak/enum.js.map
733 /agent/plugin/jailbreak/enum.js
6773 /agent/plugin/jailbreak/hooks.js.map
6952 /agent/plugin/jailbreak/hooks.js
193 /agent/plugin/jailbreak/include.js.map
75 /agent/plugin/jailbreak/include.js
156 /agent/plugin/jailbreak/jail.js.map
9 /agent/plugin/jailbreak/jail.js
764 /agent/plugin/jailbreak/thread.js.map
512 /agent/plugin/jailbreak/thread.js
176 /agent/plugin/lang/include.js.map
51 /agent/plugin/lang/include.js
2464 /agent/plugin/lang/oc/ViewController.js.map
2832 /agent/plugin/lang/oc/ViewController.js
2248 /agent/plugin/lang/oc/button.js.map
2499 /agent/plugin/lang/oc/button.js
564 /agent/plugin/lang/oc/clazz.js.map
330 /agent/plugin/lang/oc/clazz.js
203 /agent/plugin/lang/oc/include.js.map
130 /agent/plugin/lang/oc/include.js
399 /agent/plugin/lang/oc/method.js.map
177 /agent/plugin/lang/oc/method.js
9776 /agent/plugin/lang/oc/oc.js.map
7583 /agent/plugin/lang/oc/oc.js
179 /agent/plugin/lang/oc/types/include.js.map
25 /agent/plugin/lang/oc/types/include.js
5791 /agent/plugin/lang/oc/types/objc_method.js.map
4749 /agent/plugin/lang/oc/types/objc_method.js
176 /agent/plugin/lang/swift/include.js.map
18 /agent/plugin/lang/swift/include.js
157 /agent/plugin/lang/swift/main.js.map
9 /agent/plugin/lang/swift/main.js
8445 /agent/plugin/memory/findsvc.js.map
20679 /agent/plugin/memory/findsvc.js
172 /agent/plugin/memory/include.js.map
21 /agent/plugin/memory/include.js
173 /agent/plugin/service/include.js.map
18 /agent/plugin/service/include.js
194 /agent/plugin/service/main.js.map
23 /agent/plugin/service/main.js
140 /agent/types.js.map
9 /agent/types.js
11191 /agent/utils.js.map
8803 /agent/utils.js
âœ„
{"version":3,"file":"index.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":["index.ts"],"mappings":"MAAO,qBACA","ignoreList":[]}
âœ„
import"./include.js";import"./logger.js";
âœ„
{"version":3,"file":"constants.js","names":["kSec","NSSearchPaths","NSUserDomainMask","NSUTF8StringEncoding","BundleType"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":["constants.ts"],"mappings":"OAEA,IAAYA,MAAZ,SAAYA,GASRA,EAAA,oCACAA,EAAA,wBACAA,EAAA,sBACAA,EAAA,yBACAA,EAAA,+BACAA,EAAA,kBACAA,EAAA,oBACAA,EAAA,yBACAA,EAAA,4BACAA,EAAA,gCACAA,EAAA,iCACAA,EAAA,uBACAA,EAAA,uBACAA,EAAA,2BACAA,EAAA,qBACAA,EAAA,4BACAA,EAAA,6BACAA,EAAA,uBACAA,EAAA,8BACAA,EAAA,iCACAA,EAAA,gCACAA,EAAA,sBACAA,EAAA,2BACAA,EAAA,uBACAA,EAAA,uBACAA,EAAA,oBACAA,EAAA,0BACAA,EAAA,qBACAA,EAAA,2BACAA,EAAA,0BACAA,EAAA,6BACAA,EAAA,iCACAA,EAAA,0BACAA,EAAA,oCACAA,EAAA,wCACAA,EAAA,8BACAA,EAAA,mDACAA,EAAA,uDACAA,EAAA,uDACAA,EAAA,6CACAA,EAAA,sBACD,CAlDH,CAAYA,YAAI,YA6Ed,IAAYC,eAAZ,SAAYA,GACVA,IAAA,mDACAA,IAAA,2DACAA,IAAA,qEACAA,IAAA,6DACAA,IAAA,2CACAA,IAAA,+CACAA,IAAA,qCACAA,IAAA,uDACAA,IAAA,6CACAA,IAAA,oDACAA,IAAA,sEACAA,IAAA,4CACAA,IAAA,0CACAA,IAAA,iEACD,CAfD,CAAYA,8BAAa,YAiBlB,MAAMC,iBAAmB,SACzB,MAAMC,qBAAuB,SAEpC,IAAYC,YAAZ,SAAYA,GACVA,IAAA,yCACAA,IAAA,0CACD,CAHD,CAAYA,wBAAU","ignoreList":[]}
âœ„
export var kSec;!function(e){e.kSecReturnAttributes="r_Attributes",e.kSecReturnData="r_Data",e.kSecReturnRef="r_Ref",e.kSecMatchLimit="m_Limit",e.kSecMatchLimitAll="m_LimitAll",e.kSecClass="class",e.kSecClassKey="keys",e.kSecClassIdentity="idnt",e.kSecClassCertificate="cert",e.kSecClassGenericPassword="genp",e.kSecClassInternetPassword="inet",e.kSecAttrService="svce",e.kSecAttrAccount="acct",e.kSecAttrAccessGroup="agrp",e.kSecAttrLabel="labl",e.kSecAttrCreationDate="cdat",e.kSecAttrAccessControl="accc",e.kSecAttrGeneric="gena",e.kSecAttrSynchronizable="sync",e.kSecAttrSynchronizableAny="syna",e.kSecAttrModificationDate="mdat",e.kSecAttrServer="srvr",e.kSecAttrDescription="desc",e.kSecAttrComment="icmt",e.kSecAttrCreator="crtr",e.kSecAttrType="type",e.kSecAttrScriptCode="scrp",e.kSecAttrAlias="alis",e.kSecAttrIsInvisible="invi",e.kSecAttrIsNegative="nega",e.kSecAttrHasCustomIcon="cusi",e.kSecProtectedDataItemAttr="prot",e.kSecAttrAccessible="pdmn",e.kSecAttrAccessibleWhenUnlocked="ak",e.kSecAttrAccessibleAfterFirstUnlock="ck",e.kSecAttrAccessibleAlways="dk",e.kSecAttrAccessibleWhenUnlockedThisDeviceOnly="aku",e.kSecAttrAccessibleWhenPasscodeSetThisDeviceOnly="akpu",e.kSecAttrAccessibleAfterFirstUnlockThisDeviceOnly="cku",e.kSecAttrAccessibleAlwaysThisDeviceOnly="dku",e.kSecValueData="v_Data"}(kSec||(kSec={}));export var NSSearchPaths;!function(e){e[e.NSApplicationDirectory=1]="NSApplicationDirectory",e[e.NSDemoApplicationDirectory=2]="NSDemoApplicationDirectory",e[e.NSDeveloperApplicationDirectory=3]="NSDeveloperApplicationDirectory",e[e.NSAdminApplicationDirectory=4]="NSAdminApplicationDirectory",e[e.NSLibraryDirectory=5]="NSLibraryDirectory",e[e.NSDeveloperDirectory=6]="NSDeveloperDirectory",e[e.NSUserDirectory=7]="NSUserDirectory",e[e.NSDocumentationDirectory=8]="NSDocumentationDirectory",e[e.NSDocumentDirectory=9]="NSDocumentDirectory",e[e.NSCoreServiceDirectory=10]="NSCoreServiceDirectory",e[e.NSAutosavedInformationDirectory=11]="NSAutosavedInformationDirectory",e[e.NSDesktopDirectory=12]="NSDesktopDirectory",e[e.NSCachesDirectory=13]="NSCachesDirectory",e[e.NSApplicationSupportDirectory=14]="NSApplicationSupportDirectory"}(NSSearchPaths||(NSSearchPaths={}));export const NSUserDomainMask=1;export const NSUTF8StringEncoding=4;export var BundleType;!function(e){e[e.NSBundleFramework=1]="NSBundleFramework",e[e.NSBundleAllBundles=2]="NSBundleAllBundles"}(BundleType||(BundleType={}));
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":["include.ts"],"mappings":"MAAO,oBACA,mBAEA","ignoreList":[]}
âœ„
import"./logger.js";import"./utils.js";import"./plugin/include.js";
âœ„
{"version":3,"file":"logger.js","names":["LogColor","Logger","static","func","called","args","linesMap","Map","colorEndDes","colorStartDes","color","LOGW","msg","LOG","YELLOW","LOGE","RED","LOGG","C32","LOGD","C36","LOGN","C35","LOGO","C33","LOGP","C34","LOGM","C92","LOGH","C95","LOGS","C96","LOGZ","C90","LOGLL","C100","LOGJSON","obj","type","space","JSON","stringify","logL","console","log","str","WHITE","error","warn","printLogColors","getLine","i","length","fillStr","key","get","index","tmpRet","set","getTextFormart","text","center","undefined","ret","fillLength","left","Math","floor","right","globalThis","logw","loge","logg","logd","logn","logo","logp","logh","logm","logz","logs","logl","newLine","lines"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":["logger.ts"],"mappings":"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","ignoreList":[]}
âœ„
export var LogColor;!function(o){o[o.WHITE=0]="WHITE",o[o.RED=1]="RED",o[o.YELLOW=3]="YELLOW",o[o.C31=31]="C31",o[o.C32=32]="C32",o[o.C33=33]="C33",o[o.C34=34]="C34",o[o.C35=35]="C35",o[o.C36=36]="C36",o[o.C41=41]="C41",o[o.C42=42]="C42",o[o.C43=43]="C43",o[o.C44=44]="C44",o[o.C45=45]="C45",o[o.C46=46]="C46",o[o.C90=90]="C90",o[o.C91=91]="C91",o[o.C92=92]="C92",o[o.C93=93]="C93",o[o.C94=94]="C94",o[o.C95=95]="C95",o[o.C96=96]="C96",o[o.C97=97]="C97",o[o.C100=100]="C100",o[o.C101=101]="C101",o[o.C102=102]="C102",o[o.C103=103]="C103",o[o.C104=104]="C104",o[o.C105=105]="C105",o[o.C106=106]="C106",o[o.C107=107]="C107"}(LogColor||(LogColor={}));export class Logger{static callOnce(o){let g=!1;return(...L)=>{if(!g)return g=!0,o(...L)}}}Logger.linesMap=new Map,Logger.colorEndDes="[0m",Logger.colorStartDes=o=>`[${o}m`,Logger.LOGW=o=>Logger.LOG(o,LogColor.YELLOW),Logger.LOGE=o=>Logger.LOG(o,LogColor.RED),Logger.LOGG=o=>Logger.LOG(o,LogColor.C32),Logger.LOGD=o=>Logger.LOG(o,LogColor.C36),Logger.LOGN=o=>Logger.LOG(o,LogColor.C35),Logger.LOGO=o=>Logger.LOG(o,LogColor.C33),Logger.LOGP=o=>Logger.LOG(o,LogColor.C34),Logger.LOGM=o=>Logger.LOG(o,LogColor.C92),Logger.LOGH=o=>Logger.LOG(o,LogColor.C95),Logger.LOGS=o=>Logger.LOG(o,LogColor.C96),Logger.LOGZ=o=>Logger.LOG(o,LogColor.C90),Logger.LOGLL=o=>Logger.LOG(o,LogColor.C100),Logger.LOGJSON=(o,g=LogColor.C36,L=1)=>Logger.LOG(JSON.stringify(o,null,L),g),Logger.logL=console.log,Logger.LOG=(o,g=LogColor.WHITE)=>{switch(g){case LogColor.WHITE:Logger.logL(o);break;case LogColor.RED:console.error(o);break;case LogColor.YELLOW:console.warn(o);break;default:Logger.logL("["+g+"m"+o+"[0m")}},Logger.printLogColors=()=>{let o="123456789";Logger.logL(`\n${getLine(16)}  listLogColors  ${getLine(16)}`);for(let g=30;g<=37;g++)Logger.logL(`\t\t${Logger.colorStartDes(g)} C${g}\t${o} ${Logger.colorEndDes}`);Logger.logL(getLine(50));for(let g=40;g<=47;g++)Logger.logL(`\t\t${Logger.colorStartDes(g)} C${g}\t${o} ${Logger.colorEndDes}`);Logger.logL(getLine(50));for(let g=90;g<=97;g++)Logger.logL(`\t\t${Logger.colorStartDes(g)} C${g}\t${o} ${Logger.colorEndDes}`);Logger.logL(getLine(50));for(let g=100;g<=107;g++)Logger.logL(`\t\t${Logger.colorStartDes(g)} C${g}\t${o} ${Logger.colorEndDes}`);Logger.logL(getLine(50))},Logger.getLine=(o,g="-")=>{if(0==o)return"";let L=o+"|"+g;if(null!=Logger.linesMap.get(L))return Logger.linesMap.get(L);for(var e=0,r="";e<o;e++)r+=g;return Logger.linesMap.set(L,r),r},Logger.getTextFormart=(o,g=LogColor.WHITE,L=" ",e=-1,r=!1)=>{null==o&&(o=""),-1==e&&(e=o.length);let l=Logger.colorStartDes(g),C=e-o.length;if(C>0){let g=Math.floor(C/2),e=C-g;r&&(g=e),l+=getLine(g,L)+o+getLine(e,L)}else l+=o;return l+=Logger.colorEndDes,l},globalThis.log=Logger.LOG,globalThis.logw=Logger.LOGW,globalThis.loge=Logger.LOGE,globalThis.logg=Logger.LOGG,globalThis.logd=Logger.LOGD,globalThis.logn=Logger.LOGN,globalThis.logo=Logger.LOGO,globalThis.logp=Logger.LOGP,globalThis.logh=Logger.LOGH,globalThis.logm=Logger.LOGM,globalThis.logz=Logger.LOGZ,globalThis.logs=Logger.LOGS,globalThis.logl=Logger.LOGLL,globalThis.LOGJSON=Logger.LOGJSON,globalThis.getLine=Logger.getLine,globalThis.printLogColors=Logger.printLogColors,globalThis.newLine=(o=1)=>Logger.LOG(getLine(o,"\n")),globalThis.LogColor=LogColor;
âœ„
{"version":3,"file":"breaker.js","names":["HK_TYPE","Breaker","static","mPtr","defaultArgsC","objc_method","addressToMethod","checkPointer","handle","hook","FRIDA_REP","force","OBJC_REP","filterMethodNameStr","startsWith","ptr","localPtr","localObj","ObjC","Class","itorMethod","method","_impl","selectorAsString","selector","includes","attachMethod","obj","callback","$ownMethods","forEach","m","impl","implementation","error","OC_Hook_Status","getNewImplFromOCMethod","call","allocOCString","substring","indexOf","method_ptr","Object","filterName","filterClass","type","undefined","length","Error","filter","ApiResolver","enumerateMatches","item","index","address","md","Process","findModuleByAddress","logd","name","sub","base","loge","globalThis","b","B","attachClass","BF","attachMethodsByFilter"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/breaker/","sources":["breaker.ts"],"mappings":"kBAASA,MAAe,iBAIxB,MAAMC,EAGKC,kBAAkBC,EAAuCC,EAAuB,GACnF,IAAIC,YAAYC,gBAAgBC,aAAaJ,IAAwBK,QAAQC,KAAKT,EAAQU,WAAW,EAAMN,EAC/G,CAGOF,oBAAoBC,EAAuCQ,GAAiB,GAC/E,IAAIN,YAAYF,GAAMM,KAAKT,EAAQY,UAAU,EAAM,EAAGD,EAC1D,CAGOT,mBAAmBC,EAAqDU,EAA8B,GAAIF,GAAiB,GAC3G,iBAARR,GAAoBA,EAAKW,WAAW,QAAOX,EAAOY,IAAIZ,IACjE,MAAMa,EAA0BT,aAAaJ,GACvCc,EAAW,IAAIC,KAAKC,MAAMH,GAChCf,EAAQmB,WAAWH,GAAU,CAACI,EAA2BC,KAClC,GAAGJ,KAAKK,iBAAiBF,EAAOG,YACpCC,SAASZ,IAAsBZ,EAAQyB,aAAaL,EAAOb,OAAQG,EAAM,GAGhG,CAEOT,kBAAkByB,EAAkBC,GACvCD,EAAIE,YAAYC,SAAQC,IACpB,IAAIV,EACAW,EACJ,IACIX,EAASM,EAAII,GACb,IACIC,EAAOX,EAAOY,c,CAChB,MAAOC,GACLF,EAAOG,eAAeC,uBAAuBf,E,EAEnD,MAAOa,GACL,MAAMV,EAAWa,KAAK,uBAAwBC,cAAcP,EAAEQ,UAAUR,EAAES,QAAQ,KAAO,KACnFC,EAAaJ,KAAK,0BAA2BV,EAAKH,GACxDH,EAAS,IAAIH,KAAKwB,OAAOD,GACzBT,EAAOK,KAAK,2BAA4BhB,E,CAE5CO,EAASP,EAAQW,EAAK,GAE9B,CAEO9B,6BAA6ByC,EAAoBC,EAAsB,GAAIC,EAAwB,QACtG,GAAkBC,MAAdH,GAAgD,GAArBA,EAAWI,OAAa,MAAM,IAAIC,MAAM,kCACvE,IAAIC,EAAiBN,EACFG,MAAfF,GAA2C,IAAfA,GAAsBD,EAAWlB,SAAS,KAE9DkB,EAAWlB,SAAS,OAC5BwB,EAAS,QAAQN,OAFjBM,EAAS,KAAKL,MAAgBD,MAIlC,IAAIO,YAAYL,GAAMM,iBAAiBF,GAAQnB,SAAQ,CAACsB,EAAMC,KAC1D,IACI,MAAMhC,EAASf,gBAAgB8C,EAAKE,SAC9BC,EAAKC,QAAQC,oBAAoBL,EAAKE,SAC5CI,KAAK,IAAIL,aAAiBD,EAAKE,kBAAkBC,GAAII,QAAQP,EAAKE,QAAQM,IAAIL,GAAIM,SAAUT,EAAKO,aAAatC,EAAOb,UACrHP,EAAQyB,aAAaL,EAAOb,O,CAC9B,MAAO0B,GACL4B,KAAK,GAAGV,EAAKE,WAAWpB,I,IAGpC,EAUJ6B,WAAWC,EAAK7D,IAA4CF,EAAQyB,aAAavB,GAAM,EAAK,EAC5F4D,WAAWE,EAAIhE,EAAQiE,YAEvBH,WAAWI,GAAKlE,EAAQmE","ignoreList":[]}
âœ„
import{HK_TYPE as t}from"../../utils.js";class e{static attachImpl(e,s=4){new objc_method(addressToMethod(checkPointer(e)).handle).hook(t.FRIDA_REP,!0,s)}static attachMethod(e,s=!1){new objc_method(e).hook(t.OBJC_REP,!0,6,s)}static attachClass(t,s="",a=!1){"string"==typeof t&&t.startsWith("0x")&&(t=ptr(t));const o=checkPointer(t),c=new ObjC.Class(o);e.itorMethod(c,((t,o)=>{`${ObjC.selectorAsString(t.selector)}`.includes(s)&&e.attachMethod(t.handle,a)}))}static itorMethod(t,e){t.$ownMethods.forEach((s=>{let a,o;try{a=t[s];try{o=a.implementation}catch(t){o=OC_Hook_Status.getNewImplFromOCMethod(a)}}catch(e){const c=call("NSSelectorFromString",allocOCString(s.substring(s.indexOf(" ")+1))),l=call("class_getInstanceMethod",t,c);a=new ObjC.Object(l),o=call("method_getImplementation",a)}e(a,o)}))}static attachMethodsByFilter(t,s="",a="objc"){if(null==t||0==t.length)throw new Error("Need args[0] filterStr: string");let o=t;null==s||""==s||t.includes("[")?t.includes("[")||(o=`*[* *${t}*]`):o=`*[${s} *${t}*]`,new ApiResolver(a).enumerateMatches(o).forEach(((t,s)=>{try{const a=addressToMethod(t.address),o=Process.findModuleByAddress(t.address);logd(`[${s}] \taddr:${t.address} offset:${o?.name}@${t.address.sub(o?.base)} ${t.name} ObjM:${a.handle}`),e.attachMethod(a.handle)}catch(e){loge(`${t.address} ${e}`)}}))}}globalThis.b=t=>{e.attachMethod(t,!0)},globalThis.B=e.attachClass,globalThis.BF=e.attachMethodsByFilter;
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/breaker/","sources":["include.ts"],"mappings":"MAAO","ignoreList":[]}
âœ„
import"./breaker.js";
âœ„
{"version":3,"file":"cipher.js","names":["CIPHER_CONFIG","enable","maxDataLength","printStack","aes","des","cast","rc4","rc2","blowfish","filter","maxInputDataLength","md2","md4","md5","sha1","sha224","sha256","sha384","sha512","COLORS","resetColor","bold","dim","italic","underline","blink","reverse","hidden","black","red","green","yellow","blue","magenta","cyan","white","bgBlack","bgRed","bgGreen","bgYellow","bgBlue","bgMagenta","bgCyan","bgWhite","CCOperation","CCAlgorithm","CCOptions","CCMode","CCPadding","CCModeOptions","CCKeySize","CCHmacAlgorithm","CCHmacAlgorithmLength","CCPseudoRandomAlgorithm","CCPBKDFAlgorithm","print_arg","addr","len","hexdump","length","e","Error","console","error","stack","pointerToInt","ptr","parseInt","toString","filterLog","msg","log","hasFilter","value","indexOf","commonHashInterceptor","name","hash","Module","findExportByName","Interceptor","attach","onEnter","args","this","concat","dataLen","toInt32","printLen","Math","min","onLeave","reval","Thread","backtrace","context","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join","ctxCache","init","model","ctx","dataMap","totalLen","originalLen","update","remainingSpace","copyLen","tmpData","Memory","alloc","copy","push","data","final","mdSha","ctxSha","retval","totalData","offset","forEach","add","checkCryptoAlgorithmEnable","algorithm","func","dataInLength","printLength","dataOut","dataOutLength","dataOutLen","readPointer","printOutLen","cRefCache","CCCryptorCreate","params","i","cRef","dataOutMap","totalOutLen","originalOutLen","finish","Key","Iv","Tweak","TweakLen","NumRounds","CCCryptorCreateWithMode","tweakLen","CCCryptorUpdate","cRefCacheKey","copyLength","outRemainingSpace","outLen","tmpDataOut","CCCryptorFinal","totalOutData","offsetOut","commonCryptoInterceptor","checkHMACAlgorithmEnable","hmac","mdLen","macOut","mdOut","commonHMACInterceptor","CCKeyDerivationPBKDF","String","CCCalibratePBKDF","commonPBKDFInterceptor"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/cipher/","sources":["cipher.ts"],"mappings":"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","ignoreList":[]}
âœ„
const t=!0,o={enable:!0,maxDataLength:240,printStack:!1,aes:!0,des:!0,"3des":!0,cast:!0,rc4:!0,rc2:!0,blowfish:!0,filter:[]},e={enable:!0,maxInputDataLength:240,printStack:!1,md2:!0,md4:!0,md5:!0,sha1:!0,sha224:!0,sha256:!0,sha384:!0,sha512:!0,filter:[]},n={enable:!0,maxInputDataLength:240,printStack:!1,sha1:!0,md5:!0,sha224:!0,sha256:!0,sha384:!0,sha512:!0,filter:[]},a={enable:!0,printStack:!1,filter:[]},l={resetColor:t?"[0m":"",bold:t?"[1m":"",dim:t?"[2m":"",italic:t?"[3m":"",underline:t?"[4m":"",blink:t?"[5m":"",reverse:t?"[7m":"",hidden:t?"[8m":"",black:t?"[30m":"",red:t?"[31m":"",green:t?"[32m":"",yellow:t?"[33m":"",blue:t?"[34m":"",magenta:t?"[35m":"",cyan:t?"[36m":"",white:t?"[37m":"",bgBlack:t?"[40m":"",bgRed:t?"[41m":"",bgGreen:t?"[42m":"",bgYellow:t?"[43m":"",bgBlue:t?"[44m":"",bgMagenta:t?"[45m":"",bgCyan:t?"[46m":"",bgWhite:t?"[47m":""},r={0:"kCCEncrypt",1:"kCCEncrypt",3:"kCCBoth"},i={0:"kCCAlgorithmAES",1:"kCCAlgorithmDES",2:"kCCAlgorithm3DES",3:"kCCAlgorithmCAST",4:"kCCAlgorithmRC4",5:"kCCAlgorithmRC2",6:"kCCAlgorithmBlowfish"},c={1:"kCCOptionPKCS7Padding",2:"kCCOptionECBMode"},s={1:"kCCModeECB",2:"kCCModeCBC",3:"kCCModeCFB",4:"kCCModeCTR",5:"kCCModeF8",6:"kCCModeLRW",7:"kCCModeOFB",8:"kCCModeXTS",9:"kCCModeRC4",10:"kCCModeCFB8",11:"kCCModeGCM",12:"kCCModeCCM"},C={0:"ccNoPadding",1:"ccPKCS7Padding",12:"ccCBCCTS3"},g={1:"kCCModeOptionCTR_LE",2:"kCCModeOptionCTR_BE"},h={16:"kCCKeySizeAES128|kCCKeySizeMaxCAST",24:"kCCKeySizeAES192|kCCKeySize3DES",32:"kCCKeySizeAES256",8:"kCCKeySizeDES|kCCKeySizeMinBlowfish",5:"kCCKeySizeMinCAST",1:"kCCKeySizeMinRC4|kCCKeySizeMinRC2",512:"kCCKeySizeMaxRC4",128:"kCCKeySizeMaxRC2",56:"kCCKeySizeMaxBlowfish"},u={0:"kCCHmacAlgSHA1",1:"kCCHmacAlgMD5",2:"kCCHmacAlgSHA256",3:"kCCHmacAlgSHA384",4:"kCCHmacAlgSHA512",5:"kCCHmacAlgSHA224"},m={0:20,1:16,2:32,3:48,4:64,5:28},d={1:"kCCPRFHmacAlgSHA1",2:"kCCPRFHmacAlgSHA224",3:"kCCPRFHmacAlgSHA256",4:"kCCPRFHmacAlgSHA384",5:"kCCPRFHmacAlgSHA512"},p={2:"kCCPBKDF2"};function y(t,o=240){try{return null==t?"\n":"\n"+hexdump(t,{length:o})+"\n"}catch(o){return o instanceof Error&&console.error("print_arg error:",o.stack),t+"\n"}}function f(t){try{return null==t?0:parseInt(t.toString())}catch(t){return t instanceof Error&&console.error("pointerToInt error:",t.stack),0}}function b(t,o){if(null==o||0==o.length)console.log(t);else{var e=!1;for(let n of o)if(null!=n&&0!=n.length&&(e=!0,t.indexOf(n)>=0))return void console.log(t);e||console.log(t)}}function k(t,o){let n=Module.findExportByName("libSystem.B.dylib",t);null!=n?(Interceptor.attach(n,{onEnter:function(o){this.log="",this.log=this.log.concat(l.green,"[*] ENTER ",t,l.resetColor,"\n");let n=o[1].toInt32(),a=Math.min(n,e.maxInputDataLength);this.log=this.log.concat("[+] Data len: ",a,"/",n,"\n"),this.log=this.log.concat("[+] Data: \n",y(o[0],a),"\n")},onLeave:function(n){this.log=this.log.concat(l.magenta,"[+] Data out len: "+o,l.resetColor,"\n"),this.log=this.log.concat(l.magenta,"[+] Data out:\n",y(n,o),l.resetColor,"\n"),e.printStack&&(this.log=this.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),this.log=this.log.concat(l.green,"[*] EXIT ",t,l.resetColor,"\n"),b(this.log,e.filter)}}),function(){let n={},a=Module.findExportByName("libSystem.B.dylib",t+"_Init");if(null==a)return void console.error(t+"_Init func is null");Interceptor.attach(a,{onEnter:function(o){let e={ctx:o[0],dataMap:[],totalLen:0,originalLen:0,log:""};n[f(o[0])]=e,e.log=e.log.concat(l.green,"[*] ENTER "+t+"_Init\n",l.resetColor)}});let r=Module.findExportByName("libSystem.B.dylib",t+"_Update");if(null==r)return void console.error(t+"_Update func is null");Interceptor.attach(r,{onEnter:function(t){let o=n[f(t[0])];if(null==o)return void console.error("model is null");let a=f(t[2]),l=e.maxInputDataLength-o.totalLen;if(a>0&&l>0){o.originalLen+=a;let e=Math.min(a,l),n=Memory.alloc(e);Memory.copy(n,t[1],e),o.dataMap.push({data:n,len:e}),o.totalLen+=e}}});let i=Module.findExportByName("libSystem.B.dylib",t+"_Final");null!=i?Interceptor.attach(i,{onEnter:function(t){this.mdSha=t[0],this.ctxSha=t[1]},onLeave:function(a){let r=n[f(this.ctxSha)];if(null==r)return void console.error(t+"_Final model is null");if(r.totalLen<=0)return void console.error("totalLen :",r.totalLen);let i=Memory.alloc(r.totalLen);var c=0;r.dataMap.forEach((function(t){Memory.copy(i.add(c),t.data,t.len),c+=t.len})),r.log=r.log.concat("[+] Data len: "+r.totalLen+"/"+r.originalLen+"\n"),r.log=r.log.concat("[+] Data :\n"),r.log=r.log.concat(y(i,r.totalLen),"\n"),0!==f(this.mdSha)?(r.log=r.log.concat(l.magenta,"[+] Data out len: "+o+"\n"),r.log=r.log.concat("[+] Data out:\n"),r.log=r.log.concat(y(ptr(this.mdSha),o),"\n",l.resetColor)):r.log=r.log.concat(l.red,"[!]: Data out: null\n",l.resetColor),e.printStack&&(r.log=r.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),r.log=r.log.concat(l.green,"[*] EXIT "+t+"_Final\n",l.resetColor),b(r.log,e.filter)}}):console.error(t+"_Final func is null")}()):console.error(t+" func is null")}!1&&(o.enable&&function(){function t(t){switch(t){case 0:return o.aes;case 1:return o.des;case 2:return o["3des"];case 3:return o.cast;case 4:return o.rc4;case 5:return o.rc2;case 6:return o.blowfish;default:return!0}}let e=Module.findExportByName("libSystem.B.dylib","CCCrypt");if(null==e)return void console.error("CCCrypt func is null");Interceptor.attach(e,{onEnter:function(e){if(this.enable=t(e[1].toInt32()),!this.enable)return;this.log="",this.log=this.log.concat(l.green,"[*] ENTER CCCrypt",l.resetColor),this.log=this.log.concat(l.yellow,"[+] CCOperation: "+r[e[0].toInt32()],l.resetColor,"\n"),this.log=this.log.concat(l.yellow,"[+] CCAlgorithm: "+i[e[1].toInt32()],l.resetColor,"\n"),this.log=this.log.concat(l.yellow,"[+] CCOptions: "+c[e[2].toInt32()],l.resetColor,"\n"),this.log=this.log.concat(l.yellow,"[+] KeySize: "+h[e[4].toInt32()],l.resetColor,"\n"),this.log=this.log.concat(l.cyan,"[+] Key: \n"+y(e[3],e[4].toInt32()),l.resetColor,"\n"),this.log=this.log.concat(l.cyan,"[+] IV: \n"+y(e[5],16),l.resetColor,"\n");let n=f(e[7]),a=Math.min(n,o.maxDataLength);this.log=this.log.concat("[+] Data len: ",a,"/",n,"\n"),this.log=this.log.concat("[+] Data : \n","\n"),this.log=this.log.concat(y(e[6],a)),this.dataOut=e[8],this.dataOutLength=e[10]},onLeave:function(t){if(!this.enable)return;let e=f(this.dataOutLength.readPointer()),n=Math.min(e,o.maxDataLength);this.log=this.log.concat(l.magenta,"[+] Data out len: ",n,"/",e,"\n"),this.log=this.log.concat("[+] Data out: \n",y(this.dataOut,n),"\n",l.resetColor),o.printStack&&(this.log=this.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),this.log=this.log.concat(l.green,"[*] EXIT CCCrypt",l.resetColor,"\n"),b(this.log,o.filter)}});let n={},a=Module.findExportByName("libSystem.B.dylib","CCCryptorCreate");if(null==a)return void console.error("CCCryptorCreate func is null ");Interceptor.attach(a,{onEnter:function(t){this.params=[];for(let o=0;o<7;o++)this.params.push(t[o])},onLeave:function(o){let e={enable:t(this.params[1]),cRef:this.params[6].readPointer(),dataMap:[],dataOutMap:[],totalLen:0,totalOutLen:0,originalLen:0,originalOutLen:0,log:"",finish:!1,CCAlgorithm:"",CCOperation:"",CCMode:"",CCKeySize:"",CCModeOptions:"",CCPadding:"",Key:"",Iv:"null",Tweak:"",TweakLen:"",NumRounds:""};n[f(e.cRef)]=e,e.enable&&(e.log=e.log.concat(l.green,"[*] ENTER CCCryptorCreate",l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCOperation: ",e.CCOperation=r[this.params[0].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCAlgorithm: "+i[this.params[1].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.cyan,"[+] Key len: ",e.CCKeySize=h[this.params[4].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.cyan,"[+] Key: \n",e.Key=y(this.params[3],f(this.params[4])),l.resetColor,"\n"),0!=f(this.params[5])?e.log=e.log.concat(l.cyan,"[+] Iv:\n",e.Iv=y(this.params[5],16),l.resetColor,"\n"):e.log=e.log.concat(l.red,"[!] Iv: null","\n",l.resetColor))}});let u=Module.findExportByName("libSystem.B.dylib","CCCryptorCreateWithMode");if(null==u)return void console.error("CCCryptorCreateWithMode func is null ");Interceptor.attach(u,{onEnter:function(t){this.params=[];for(let o=0;o<12;o++)this.params.push(t[o])},onLeave:function(o){let e={enable:t(this.params[2]),cRef:ptr(0),dataMap:[],dataOutMap:[],totalLen:0,totalOutLen:0,originalLen:0,originalOutLen:0,log:"",finish:!1,CCAlgorithm:"",CCOperation:"",CCMode:"",CCKeySize:"",CCModeOptions:"",CCPadding:"",Key:"",Iv:"null",Tweak:"",TweakLen:"",NumRounds:""};try{e.cRef=this.params[11].readPointer()}catch(t){return void console.log("Error: read CCCryptorRef failed:",t)}if(n[f(e.cRef)]=e,!e.enable)return;e.log=e.log.concat(l.green,"[*] ENTER CCCryptorCreateWithMode",l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCOperation: ",e.CCOperation=r[this.params[0].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCMode: ",e.CCMode=s[this.params[1].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCAlgorithm: ",e.CCAlgorithm=i[this.params[2].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCPadding: ",e.CCPadding=C[this.params[3].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] CCModeOptions: ",e.CCModeOptions=g[this.params[10].toInt32()],l.resetColor,"\n");let a=this.params[8].toInt32();a>0&&0!=f(this.params[7])&&(e.log=e.log.concat(l.cyan,"[+] tweak len: ",e.TweakLen=a,l.resetColor,"\n"),e.log=e.log.concat(l.cyan,"[+] tweak: \n",e.Tweak=y(this.params[7],f(this.params[8])),l.resetColor,"\n")),e.log=e.log.concat(l.cyan,"[+] numRounds: ",e.NumRounds=this.params[9].toInt32(),l.resetColor,"\n"),e.log=e.log.concat(l.cyan,"[+] Key len: ",e.CCKeySize=h[this.params[6].toInt32()],l.resetColor,"\n"),e.log=e.log.concat(l.cyan,"[+] Key: \n",e.Key=y(this.params[5],f(this.params[6])),l.resetColor,"\n"),0!=f(this.params[4])?e.log=e.log.concat(l.cyan,"[+] Iv:\n",e.Iv=y(this.params[4],16),l.resetColor,"\n"):e.log=e.log.concat(l.red,"[!] Iv: null","\n",l.resetColor)}});let m=Module.findExportByName("libSystem.B.dylib","CCCryptorUpdate");if(null==m)return void console.error("CCCryptorUpdate func is null");Interceptor.attach(m,{onEnter:function(t){this.params=[];for(let o=0;o<6;o++)this.params.push(t[o])},onLeave:function(t){let e=n[f(this.params[0])];if(null==e){e={enable:o.enable,cRef:this.params[0],dataMap:[],dataOutMap:[],totalLen:0,totalOutLen:0,originalLen:0,originalOutLen:0,log:"",finish:!1,CCAlgorithm:"",CCOperation:"",CCMode:"",CCKeySize:"",CCModeOptions:"",CCPadding:"",Key:"",Iv:"",Tweak:"",TweakLen:"",NumRounds:""},e.log=e.log.concat(l.green,"[*] ENTER CCCryptorUpdate (note: Cannot be associated with an existing CCCryptorRef, so the data encryption parameters are unknown, However, a list of encryption instances that are currently still being processed can be provided here.)",l.resetColor,"\n"),e.log=e.log.concat(l.blue,"[=] The list is as follows:",l.resetColor,"\n");for(let t in n){let o=n[t];null==o||o.finish||(e.log=e.log.concat(l.cyan,"[+] CCCryptorRef: ",o.cRef+"(pointer)"," dump:\n",l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCAlgorithm: ",o.CCAlgorithm,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCOperation: ",o.CCOperation,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCMode: ",o.CCMode,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCKeySize: ",o.CCKeySize,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCModeOptions: ",o.CCModeOptions,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : CCPadding: ",o.CCPadding,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : Key: ",o.Key,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : Iv: ",o.Iv,l.resetColor,"\n"),parseInt(o.TweakLen)>0&&(e.log=e.log.concat(l.yellow,"[+] : TweakLen: ",o.TweakLen,l.resetColor,"\n"),e.log=e.log.concat(l.yellow,"[+] : Tweak: ",o.Tweak,l.resetColor,"\n")),e.log=e.log.concat(l.yellow,"[+] : NumRounds: ",o.NumRounds,l.resetColor,"\n"))}e.log=e.log.concat(l.blue,"[=] End of list",l.resetColor,"\n"),n[f(this.params[0])]=e}if(!e.enable)return;e.originalLen+=this.params[2].toInt32();let a=o.maxDataLength-e.totalLen,r=f(this.params[2]);if(r>0&&a>0){let t=Math.min(r,a),o=Memory.alloc(t);Memory.copy(o,this.params[1],t),e.dataMap.push({data:o,len:t}),e.totalLen+=t}let i=o.maxDataLength-e.totalOutLen,c=f(this.params[5].readPointer());if(e.originalOutLen+=c,c>0&&i>0){let t=Math.min(c,i),o=Memory.alloc(t);Memory.copy(o,this.params[3],t),e.dataOutMap.push({data:o,len:t}),e.totalOutLen+=t}}});let d=Module.findExportByName("libSystem.B.dylib","CCCryptorFinal");null!=d?Interceptor.attach(d,{onEnter:function(t){this.params=[];for(let o=0;o<4;o++)this.params.push(t[o])},onLeave:function(t){let e=n[f(this.params[0])];if(null==e)return void console.error("CCCryptorFinal model is null");if(!e.enable)return;if(e.totalOutLen<o.maxDataLength){let t=o.maxDataLength-e.totalOutLen,n=f(this.params[3].readPointer());if(e.originalOutLen+=n,n>0&&t>0){let o=Math.min(n,t),a=Memory.alloc(o);Memory.copy(a,this.params[1],o),e.dataOutMap.push({data:a,len:o}),e.totalOutLen+=o}}let a=Memory.alloc(e.totalLen);var r=0;e.dataMap.forEach((function(t){Memory.copy(a.add(r),t.data,t.len),r+=t.len}));let i=Memory.alloc(e.totalOutLen);var c=0;e.dataOutMap.forEach((function(t){Memory.copy(i.add(c),t.data,t.len),c+=t.len})),e.log=e.log.concat("[+] Data len: "+e.totalLen+"/"+e.originalLen+"\n"),e.log=e.log.concat("[+] Data : \n",y(a,e.totalLen),"\n"),e.log=e.log.concat(l.magenta,"[+] Data out len: "+e.totalOutLen+"/"+e.originalOutLen+"\n"),e.log=e.log.concat("[+] Data out: \n",y(i,e.totalOutLen),"\n",l.resetColor),o.printStack&&(e.log=e.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),e.log=e.log.concat(l.green,"[*] EXIT CCCryptorFinal ",l.resetColor,"\n"),e.finish=!0,b(e.log,o.filter)}}):console.error("CCCryptorFinal func is null")}(),e.enable&&(e.sha1&&k("CC_SHA1",20),e.sha224&&k("CC_SHA224",28),e.sha256&&k("CC_SHA256",32),e.sha384&&k("CC_SHA384",48),e.sha512&&k("CC_SHA512",64),e.md2&&k("CC_MD2",16),e.md4&&k("CC_MD4",16),e.md5&&k("CC_MD5",16),n.enable&&function(){function t(t){switch(t){case 0:return n.sha1;case 1:return n.md5;case 2:return n.sha256;case 3:return n.sha384;case 4:return n.sha512;case 5:return n.sha224;default:return!0}}let o="CCHmac",e=Module.findExportByName("libSystem.B.dylib",o);null!=e?(Interceptor.attach(e,{onEnter:function(e){if(this.enable=t(e[0].toInt32()),!this.enable)return;this.mdLen=m[e[0].toInt32()],this.log="",this.log=this.log.concat(l.green,"[*] ENTER ",o,"\n"),this.log=this.log.concat(l.yellow,"[+] Algorithm: ",u[e[0].toInt32()],"\n",l.resetColor),this.log=this.log.concat(l.cyan,"[+] Key len: ",e[2].toInt32(),"\n"),this.log=this.log.concat(l.cyan,"[+] Key : \n",y(e[1],e[2].toInt32()),"\n",l.resetColor);let a=e[4].toInt32(),r=Math.min(a,n.maxInputDataLength);this.log=this.log.concat("[+] Data len: ",r,"/",a,"\n"),this.log=this.log.concat("[+] Data: \n",y(e[3],r),"\n"),this.macOut=e[5]},onLeave:function(t){this.enable&&(this.log=this.log.concat(l.magenta,"[+] Data out len: "+this.mdLen,l.resetColor,"\n"),this.log=this.log.concat(l.magenta,"[+] Data out:\n",y(this.macOut,this.mdLen),l.resetColor,"\n"),n.printStack&&(this.log=this.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),this.log=this.log.concat(l.green,"[*] EXIT ",o,l.resetColor,"\n"),b(this.log,n.filter))}}),function(){let e={},a=Module.findExportByName("libSystem.B.dylib",o+"Init");if(null==a)return void console.error(o+"Init func is null");Interceptor.attach(a,{onEnter:function(o){let n={ctx:o[0],dataMap:[],totalLen:0,originalLen:0,log:"",mdLen:m[o[1].toInt32()],enable:t(o[1].toInt32())};e[f(o[0])]=n,n.enable&&(n.log=n.log.concat(l.green,"[*] ENTER CCHmacInit\n",l.resetColor),n.log=n.log.concat(l.yellow,"[+] Algorithm: "+u[o[1].toInt32()]+"\n",l.resetColor),n.log=n.log.concat(l.cyan,"[+] Key len: "+o[3].toInt32()+l.resetColor+"\n"),n.log=n.log.concat(l.cyan,"[+] Key: \n"+y(o[2],f(o[3]))+"\n",l.resetColor))}});let r=Module.findExportByName("libSystem.B.dylib",o+"Update");if(null==r)return void console.error(o+"Update func is null");Interceptor.attach(r,{onEnter:function(t){let a=e[f(t[0])];if(null==a)return void console.error(o+"Update model is null");if(!a.enable)return;let l=f(t[2]),r=n.maxInputDataLength-a.totalLen;if(l>0&&r>0){a.originalLen+=l;let o=Math.min(l,r),e=Memory.alloc(o);Memory.copy(e,t[1],o),a.dataMap.push({data:e,len:o}),a.totalLen+=o}}});let i=Module.findExportByName("libSystem.B.dylib",o+"Final");null!=i?Interceptor.attach(i,{onEnter:function(t){this.mdOut=t[1],this.ctx=t[0]},onLeave:function(t){let a=e[f(this.ctx)];if(null==a)return void console.error(o+"Final model is null");if(!a.enable)return;if(a.totalLen<=0)return void console.error("totalLen :",a.totalLen);let r=Memory.alloc(a.totalLen);var i=0;a.dataMap.forEach((function(t){Memory.copy(r.add(i),t.data,t.len),i+=t.len})),a.log=a.log.concat("[+] Data len: "+a.totalLen+"/"+a.originalLen+"\n"),a.log=a.log.concat("[+] Data :\n"),a.log=a.log.concat(y(r,a.totalLen),"\n"),a.log=a.log.concat(l.magenta,"[+] Data out len: "+a.mdLen+"\n"),a.log=a.log.concat("[+] Data out:\n"),a.log=a.log.concat(y(ptr(this.mdOut),a.mdLen),"\n",l.resetColor),n.printStack&&(a.log=a.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),a.log=a.log.concat(l.green,"[*] EXIT CCHmacFinal\n",l.resetColor),b(a.log,n.filter)}}):console.error(o+"Final func is null")}()):console.error(o+" func is null")}(),a.enable&&function(){let t=Module.findExportByName("libSystem.B.dylib","CCKeyDerivationPBKDF");if(null==t)return void console.error("CCKeyDerivationPBKDF func is null");Interceptor.attach(t,{onEnter:function(t){this.params=[];for(let o=0;o<9;o++)this.params.push(t[o])},onLeave:function(t){var o="";o=(o=(o=(o=(o=(o=(o=(o=(o=(o=o.concat(l.green,"[*] ENTER CCKeyDerivationPBKDF",l.resetColor,"\n")).concat(l.yellow,"[+] Algorithm: ",p[this.params[0].toInt32()],"\n",l.resetColor)).concat(l.yellow,"[+] PseudoRandomAlgorithm: ",d[this.params[5].toInt32()],"\n",l.resetColor)).concat(l.cyan,"[+] Rounds: ",String(f(this.params[6])),"\n",l.resetColor)).concat(l.cyan,"[+] Password len: ",this.params[2].toInt32(),"\n")).concat(l.cyan,"[+] Password : \n",y(this.params[1],this.params[2].toInt32()),"\n",l.resetColor)).concat(l.cyan,"[+] Salt len: ",this.params[4].toInt32(),"\n")).concat(l.cyan,"[+] Salt : \n",y(this.params[3],this.params[4].toInt32()),"\n",l.resetColor)).concat(l.cyan,"[+] DerivedKey len: ",this.params[8].toInt32(),"\n")).concat(l.cyan,"[+] DerivedKey : \n",y(this.params[7],this.params[8].toInt32()),"\n",l.resetColor),a.printStack&&(o=o.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),b(o=o.concat(l.green,"[*] EXIT CCKeyDerivationPBKDF",l.resetColor,"\n"),a.filter)}});let o=Module.findExportByName("libSystem.B.dylib","CCCalibratePBKDF");null!=o?Interceptor.attach(o,{onEnter:function(t){this.log="",this.log=this.log.concat(l.green,"[*] ENTER CCCalibratePBKDF",l.resetColor,"\n"),this.log=this.log.concat(l.yellow,"[+] Algorithm: ",p[t[0].toInt32()],"\n",l.resetColor),this.log=this.log.concat(l.yellow,"[+] PseudoRandomAlgorithm: ",d[t[3].toInt32()],"\n",l.resetColor),this.log=this.log.concat(l.cyan,"[+] Password len: ",t[1].toInt32(),l.resetColor,"\n"),this.log=this.log.concat(l.cyan,"[+] Salt len: ",t[2].toInt32(),l.resetColor,"\n"),this.log=this.log.concat(l.cyan,"[+] DerivedKey len: ",t[4].toInt32(),l.resetColor,"\n"),this.log=this.log.concat(l.cyan,"[+] Msec : ",f(t[5]),l.resetColor,"\n")},onLeave:function(t){this.log=this.log.concat(l.cyan,"[+] IterNum : \n",f(t),l.resetColor,"\n"),a.printStack&&(this.log=this.log.concat(l.blue,"[+] stack:\n",Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n"),l.resetColor,"\n")),this.log=this.log.concat(l.green,"[*] EXIT CCCalibratePBKDF",l.resetColor,"\n"),b(this.log,a.filter)}}):console.error("CCCalibratePBKDF func is null")}()));
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/foundation/","sources":["include.ts"],"mappings":"MAAO,mBACA","ignoreList":[]}
âœ„
import"./nslog.js";import"./nsbundle.js";
âœ„
{"version":3,"file":"nsbundle.js","names":["globalThis","get_BundleIdentifier","ObjC","classes","toString"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/foundation/","sources":["nsbundle.ts"],"mappings":"AAWAA,WAAWC,qBARkB,IAClBC,KAAKC,QAAkB,SAAc,aAAsB,mBAAIC","ignoreList":[]}
âœ„
globalThis.get_BundleIdentifier=()=>ObjC.classes.NSBundle.mainBundle().bundleIdentifier().toString();export{};
âœ„
{"version":3,"file":"nslog.js","names":["globalThis","B_NSLOG","address","Module","findExportByName","loge","Interceptor","attach","onEnter","args","fmt","ObjC","Object","toString","count_args","split","length","args_str","i","logd"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/foundation/","sources":["nslog.ts"],"mappings":"AAwBAA,WAAWC,QAtBK,KACZ,MAAMC,EAAUC,OAAOC,iBAAiB,aAAc,SACtD,IAAKF,EAAS,OAAOG,KAAK,4BAE1BC,YAAYC,OAAOL,EAAU,CACzBM,QAAQC,GACJ,MAAMC,EAAM,IAAIC,KAAKC,OAAOH,EAAK,IAAII,WAC/BC,EAAaJ,EAAIK,MAAM,KAAKC,OAAS,EAC3C,IAAIC,EAAW,GACf,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAW,EAAGI,IAC9BD,GAAYR,EAAKS,GAAGL,WACpBI,GAAY,KAEhBE,KAAK,UAAUT,OAASO,IAC5B,GACF","ignoreList":[]}
âœ„
globalThis.B_NSLOG=()=>{const t=Module.findExportByName("Foundation","NSLog");if(!t)return loge("NSLog address not found!");Interceptor.attach(t,{onEnter(t){const o=new ObjC.Object(t[0]).toString(),n=o.split("%").length-1;let e="";for(let o=1;o<n+1;o++)e+=t[o].toString(),e+=", ";logd(`NSLog: ${o} | ${e}`)}})};export{};
âœ„
{"version":3,"file":"NSOperationQueue.js","names":["globalThis","hook_NSOperationQueue","Interceptor","attach","ObjC","classes","implementation","onEnter","args","ins","Object","sel","selectorAsString","blk","Block","console","warn","logz","Thread","backtrace","this","context","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join","msg","onLeave","retval","msgL","logd"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/hooks/","sources":["NSOperationQueue.ts"],"mappings":"AAMAA,WAAWC,sBAAwB,KAgB/BC,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,4BAA4BC,eAAgB,CAC5FC,QAAQC,GACJ,MAAMC,EAAM,IAAIL,KAAKM,OAAOF,EAAK,IAC3BG,EAAMP,KAAKQ,iBAAiBJ,EAAK,IACjCK,EAAM,IAAIT,KAAKU,MAAMN,EAAK,IAChCO,QAAQC,KAAK,6CAA6CP,KAAOE,KAAOE,OAASL,EAAK,MACtFS,KAAK,iBAAiBC,OAAOC,UAAUC,KAAKC,QAASC,WAAWC,UAAUC,IAAIC,YAAYC,aAAaC,KAAK,YAChH,IAIJzB,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,mBAAmBC,eAAgB,CACnFC,QAAQC,GACJ,MAAMC,EAAM,IAAIL,KAAKM,OAAOF,EAAK,IAC3BG,EAAMP,KAAKQ,iBAAiBJ,EAAK,IACjCK,EAAM,IAAIT,KAAKU,MAAMN,EAAK,IAChCO,QAAQC,KAAK,oCAAoCP,KAAOE,KAAOE,OAASL,EAAK,MAC7ES,KAAK,iBAAiBC,OAAOC,UAAUC,KAAKC,QAASC,WAAWC,UAAUC,IAAIC,YAAYC,aAAaC,KAAK,YAChH,IAgBJzB,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,eAAeC,eAAgB,CAC/EC,QAAQC,GACJ,MAAMC,EAAM,IAAIL,KAAKM,OAAOF,EAAK,IAC3BG,EAAMP,KAAKQ,iBAAiBJ,EAAK,IACvCY,KAAKQ,IAAM,iCAAiCnB,KAAOE,GACvD,EACAkB,QAAQC,GACJ,IAAIC,EAAOX,KAAKQ,IAChBI,KAAK,GAAG,IAAI5B,KAAKM,OAAOoB,QAAaC,KACrCd,KAAK,iBAAiBC,OAAOC,UAAUC,KAAKC,QAASC,WAAWC,UAAUC,IAAIC,YAAYC,aAAaC,KAAK,YAChH,GACF","ignoreList":[]}
âœ„
globalThis.hook_NSOperationQueue=()=>{Interceptor.attach(ObjC.classes.NSOperationQueue["- addOperationWithBlock:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]),n=ObjC.selectorAsString(e[1]),o=new ObjC.Block(e[2]);console.warn(`-[NSOperationQueue addOperationWithBlock] ${t} ${n} ${o} @ ${e[2]}`),logz(`called from:\n${Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t")}\n`)}}),Interceptor.attach(ObjC.classes.NSOperationQueue["- addOperation:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]),n=ObjC.selectorAsString(e[1]),o=new ObjC.Block(e[2]);console.warn(`-[NSOperationQueue addOperation] ${t} ${n} ${o} @ ${e[2]}`),logz(`called from:\n${Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t")}\n`)}}),Interceptor.attach(ObjC.classes.NSOperationQueue["+ mainQueue"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]),n=ObjC.selectorAsString(e[1]);this.msg=`-[NSOperationQueue mainQueue] ${t} ${n}`},onLeave(e){let t=this.msg;logd(`${new ObjC.Object(e)} = ${t}`),logz(`called from:\n${Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t")}\n`)}})};export{};
âœ„
{"version":3,"file":"UILabel.js","names":["globalThis","hook_UILabel","Interceptor","attach","ObjC","classes","implementation","onEnter","args","ins","Object","sel","selectorAsString","nsstring","console","warn","logz","Thread","backtrace","this","context","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/hooks/","sources":["UILabel.ts"],"mappings":"AAMAA,WAAWC,aAAe,KAGtBC,YAAYC,OAAOC,KAAKC,QAAiB,QAAE,cAAcC,eAAgB,CACrEC,QAAQC,GACJ,MAAMC,EAAM,IAAIL,KAAKM,OAAOF,EAAK,IAC3BG,EAAMP,KAAKQ,iBAAiBJ,EAAK,IACjCK,EAAW,IAAIT,KAAKM,OAAOF,EAAK,IACtCM,QAAQC,KAAK,sBAAsBN,KAAOE,MAAQE,MAClDG,KAAK,iBAAiBC,OAAOC,UAAUC,KAAKC,QAASC,WAAWC,UAAUC,IAAIC,YAAYC,aAAaC,KAAK,YAChH,GACF","ignoreList":[]}
âœ„
globalThis.hook_UILabel=()=>{Interceptor.attach(ObjC.classes.UILabel["- setText:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]),o=ObjC.selectorAsString(e[1]),a=new ObjC.Object(e[2]);console.warn(`-[UILabel setText] ${t} ${o} '${a}'`),logz(`called from:\n${Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t")}\n`)}})};export{};
âœ„
{"version":3,"file":"dyld.js","names":["globalThis","hook_dyld_log","A","getSym","address","args","logd","readCString","hook_dyld_get_image_name","logw","Process","id","undefined","ret","ctx","getCurrentThreadId","toInt32","logz","Thread","backtrace","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join","Interceptor","attach","onEnter","this","msg","index","onLeave","retval","mm","mm1","toLowerCase","includes","newStr","Memory","allocUtf8String","replace","context","hook_dyld_mod_init_funcs","offset","NativeCallback","addr","maxInsItor","current","Instruction","parse","findModuleByName","addr_helper","mnemonic","next_1","next","next_2","next_3","v_2","Number","operands","filter","i","type","value","v_3","equals","NULL","findOffset","_args","x24L","x24","debuginfo","toString","hook_dyld_doModInitFunctions","hook_dyld_ImageLoader_findExportedSymbol","_ctx","pv","set","get","hook_dyld_ImageLoader_recursiveInitialization","dyld_register_func","func","addr_dyld_register_func","fromName","NativeFunction","func_dyld_register_func","header","slide"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/hooks/","sources":["dyld.ts"],"mappings":"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","ignoreList":[]}
âœ„
globalThis.hook_dyld_log=()=>{A(getSym("dyld::log","dyld")[0].address,(e=>{logd(`dyld::log ${e[0].readCString()}`)}))},globalThis.hook_dyld_get_image_name=()=>{logw(`MAIN Process ${Process.id}`),A(getSym("_dyld_image_count","dyld")[0].address,void 0,((e,d)=>{logd(`[ ${Process.getCurrentThreadId()} ] \tcalled _dyld_image_count -> ${e.toInt32()}`),logz(`called from:\n${Thread.backtrace(d,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\t\n")}\n`)})),Interceptor.attach(getSym("_dyld_get_image_name","dyld")[0].address,{onEnter(e){this.msg=`_dyld_get_image_name( ${e[0]} | ${e[0].toInt32()} )`,this.index=e[0].toInt32()},onLeave(e){let d=`${e} = ${this.msg}\t<-\t${e.readCString()}`,t=d.toLowerCase();if(0==this.index||t.includes("libsubstrate")||d.includes("CepheiUI")||t.includes("substrate")||t.includes("substitute-loader.dylib")||t.includes("libsubstitute.0.dylib")||t.includes("libsubstrate.dylib")||t.includes("FridaAgent")||t.includes("FlyJB2.dylib")||t.includes("HideJB.dylib")||t.includes("Cephei")||t.includes("CepheiUI")||t.includes("zzzzzzzzzNotifyChroot.dylib")||t.includes("zzzzLiberty.dylib")||t.includes("Cephei")||t.includes("Cephei")){const t=Memory.allocUtf8String(e.readCString().replace("substrate","sub").replace("stitute","sub"));e.replace(t),logw(d+" | modify to "+e.readCString()),logz(`called from:\n${Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t")}\n`)}else logd(d)}})},globalThis.hook_dyld_mod_init_funcs=e=>{new NativeCallback((()=>{logd("nop call 'KSAdSDK!registerDyldCallback'")}),"void",[]);A(null!=e?e:function(){const e=getSym("ImageLoaderMachO::doModInitFunctions","dyld")[0].address;let d=200,t=Instruction.parse(e);Process.findModuleByName("dyld");const o=getSym("_ZN4dyld17gLibSystemHelpersE","dyld")[0].address;for(;--d>0;){if("blr"==t.mnemonic){const e=Instruction.parse(t.next),d=Instruction.parse(e.next),i=Instruction.parse(d.next);if("adrp"==d.mnemonic&&"add"==i.mnemonic){const e=Number(d.operands.filter((e=>"imm"==e.type))[0].value),n=Number(i.operands.filter((e=>"imm"==e.type))[0].value);if(o.equals(e+n))return t.address}}t=Instruction.parse(t.next)}return NULL}(),((e,d)=>{const t=d.x24,o=DebugSymbol.fromAddress(t).toString();logd(`call init -> ${t} | ${o}`)}))},globalThis.hook_dyld_doModInitFunctions=()=>{A(getSym("doModInitFunctions","dyld")[0].address,(e=>{logd(`Enter doModInitFunctions ImageLoaderMachO:${e[0]} LinkContext&:${e[1]}`)}),(()=>{logd("Exit doModInitFunctions\n")}))},globalThis.hook_dyld_ImageLoader_findExportedSymbol=()=>{A(getSym("ImageLoaderMachO::findExportedSymbol","dyld")[0].address,((e,d,t)=>{t.set("pv",`ImageLoaderMachO::findExportedSymbol( INS:${e[0]}, name=${e[1].readCString()}, searchReExports=${e[2]}, thisPath=${e[3].readCString()}, foundIn=${e[4]} )`)}),((e,d,t)=>{logd(`Sym*:${e} = ${t.get("pv")}`)}))},globalThis.hook_dyld_ImageLoader_recursiveInitialization=()=>{A(getSym("ImageLoader::recursiveInitialization","dyld")[0].address,(e=>{logd(`called ImageLoader::recursiveInitialization( ImageLoader:${e[0]}, context:${e[1]}, this_thread:${e[2].toInt32()}`)}))},globalThis.dyld_register_func=e=>{const d=DebugSymbol.fromName("_dyld_register_func_for_add_image").address;new NativeFunction(d,"pointer",["pointer"])(new NativeCallback((function(d,t){return logd(`_dyld_register_func_for_add_image ${d} ${t}`),e(d,t),NULL}),"pointer",["pointer","pointer"]))};export{};
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/hooks/","sources":["include.ts"],"mappings":"MAAO,kBACA,qBACA,8BACA","ignoreList":[]}
âœ„
import"./dyld.js";import"./libdyld.js";import"./NSOperationQueue.js";import"./UILabel.js";
âœ„
{"version":3,"file":"libdyld.js","names":["globalThis","hook_dlopen","onCall","printBackTrace","A","DebugSymbol","fromName","address","args","ctx","pv","isNull","name","readCString","set","logw","Thread","backtrace","Backtracer","ACCURATE","map","fromAddress","join","retval","_ctx","logd","get"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/hooks/","sources":["libdyld.ts"],"mappings":"AAAAA,WAAWC,YAAc,CAACC,EAA6BC,GAAuB,KAE1EC,EAAEC,YAAYC,SAAS,UAAUC,SAAS,CAACC,EAAKC,EAAIC,KAChD,GAAIF,EAAK,GAAGG,SAAU,OAClB,MAAMC,EAAOJ,EAAK,GAAGK,cACrBH,EAAGI,IAAI,MAAO,YAAYN,EAAK,MAAMI,MAASJ,EAAK,QAC/CL,GAAgBY,KAAK,wBAA0BC,OAAOC,UAAUR,EAAKS,WAAWC,UAAUC,IAAIf,YAAYgB,aAAaC,KAAK,MAAQ,KAAK,IAC/I,CAACC,EAAQC,EAAMd,KACbe,KAAK,GAAGF,OAAYb,EAAGgB,IAAI,SAAS,GAE3C","ignoreList":[]}
âœ„
globalThis.hook_dlopen=(e,o=!1)=>{A(DebugSymbol.fromName("dlopen").address,((e,l,r)=>{if(e[0].isNull())return;const d=e[0].readCString();r.set("msg",`dlopen ( ${e[0]} ${d}, ${e[1]} )`),o&&logw("dlopen called from:\n"+Thread.backtrace(l,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n")+"\n")}),((e,o,l)=>{logd(`${e} = ${l.get("msg")}`)}))};export{};
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/","sources":["include.ts"],"mappings":"MAAO,2BAEA,gCACA,+BACA,6BACA,6BACA,0BACA,2BACA","ignoreList":[]}
âœ„
import"./cipher/cipher.js";import"./foundation/include.js";import"./jailbreak/include.js";import"./service/include.js";import"./breaker/include.js";import"./lang/include.js";import"./hooks/include.js";import"./memory/include.js";
âœ„
{"version":3,"file":"enum.js","names":["CTL_KERN","CTLT_YPE"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/jailbreak/","sources":["enum.ts"],"mappings":"OAkFA,IAAYA,UAAZ,SAAYA,GACRA,IAAA,mCACAA,IAAA,kCACAA,IAAA,8BACAA,IAAA,oCACAA,IAAA,4BACAA,IAAA,0BACAA,IAAA,0BACAA,IAAA,0BACAA,IAAA,8BACAA,IAAA,+BAEH,CAZD,CAAYA,oBAAQ,YA2BpB,IAAYC,UAAZ,SAAYA,GACRA,IAAA,2BACAA,IAAA,uBACAA,IAAA,mBACAA,IAAA,qBACAA,IAAA,qBACAA,IAAA,yBACAA,IAAA,mBACAA,IAAA,6BACAA,IAAA,uBACAA,IAAA,wBACH,CAXD,CAAYA,oBAAQ","ignoreList":[]}
âœ„
export var CTL_KERN;!function(E){E[E.KERN_SECURELVL=9]="KERN_SECURELVL",E[E.KERN_HOSTNAME=10]="KERN_HOSTNAME",E[E.KERN_HOSTID=11]="KERN_HOSTID",E[E.KERN_CLOCKRATE=12]="KERN_CLOCKRATE",E[E.KERN_VNODE=13]="KERN_VNODE",E[E.KERN_PROC=14]="KERN_PROC",E[E.KERN_FILE=15]="KERN_FILE",E[E.KERN_PROF=16]="KERN_PROF",E[E.KERN_POSIX1=17]="KERN_POSIX1",E[E.KERN_NGROUPS=18]="KERN_NGROUPS"}(CTL_KERN||(CTL_KERN={}));export var CTLT_YPE;!function(E){E[E.CTL_UNSPEC=0]="CTL_UNSPEC",E[E.CTL_KERN=1]="CTL_KERN",E[E.CTL_VM=2]="CTL_VM",E[E.CTL_VFS=3]="CTL_VFS",E[E.CTL_NET=4]="CTL_NET",E[E.CTL_DEBUG=5]="CTL_DEBUG",E[E.CTL_HW=6]="CTL_HW",E[E.CTL_MACHDEP=7]="CTL_MACHDEP",E[E.CTL_USER=8]="CTL_USER",E[E.CTL_MAXID=9]="CTL_MAXID"}(CTLT_YPE||(CTLT_YPE={}));
âœ„
{"version":3,"file":"hooks.js","names":["checkIfContainJbPaths","str","some","item","includes","hook_stat","logd","addr","Module","findExportByName","Interceptor","attach","onEnter","args","this","disp","readCString","onLeave","retval","loge","replace","ptr","addr2","hook_get_image_name","toInt32","ret_str","disp_str","new_ret","Memory","allocUtf8String","Thread","backtrace","context","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join","hook_canOpenURL","old_Method_canOpenURL","ObjC","classes","old_impl","implementation","implement","clazz","selector","URLString","Object","selectorAsString","hook_URLWithString","old_func","NSURL","URLWithString_","toCString","toString","NSString","stringWithString_","hook_NSFileManager","isOpenJailFile","NSFileManager","fileExistsAtPath","isDirectory","fileName","hook_getenv","envName","NULL","hook_ptrace","srcCall","NativeFunction","revert","NativeCallback","request","pid","data","hook_NSClassFromString","checkArray","className","error","globalThis","hook_all_detect","hook_NSString_IsEqualToString","logw","thiz","SEL","hook_isDebugged","addr_sysctl","tmp","i","add","readInt","disp1","substring","length","info","logz","p_flag_addr","Process","pointerSize","readPointer","writePointer","and","hook_exit","console","warn","log","hook_strcmp","arg0","arg1"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/jailbreak/","sources":["hooks.ts"],"mappings":"AAEA,MAEMA,EAAyBC,GAEX,CACZ,0BACA,iBACA,YACA,WACA,2BACA,sBACA,wBACA,0BACA,aACA,YACA,YAEWC,MAAKC,GAAQF,EAAIG,SAASD,YAGtC,MAAME,UAAY,KACrBC,KAAK,qBAuBL,MAAMC,EAAOC,OAAOC,iBAAiB,yBAA0B,QAC/DC,YAAYC,OAAOJ,EAAM,CACrBK,QAAQC,GACJC,KAAKC,KAAO,WAAWF,EAAK,GAAGG,mBAAmBH,EAAK,MAC3D,EACAI,QAAQC,GACAlB,EAAsBc,KAAKC,QAC3BI,KAAK,GAAGD,QAAaJ,KAAKC,QAC1BG,EAAOE,QAAQC,KAAK,IAI5B,IAIJ,MAAMC,EAAQd,OAAOC,iBAAiB,yBAA0B,SAChEC,YAAYC,OAAOW,EAAO,CACtBV,QAAQC,GACJC,KAAKC,KAAO,YAAYF,EAAK,GAAGG,mBAAmBH,EAAK,MAC5D,EACAI,QAAQC,GACAlB,EAAsBc,KAAKC,QAC3BI,KAAK,GAAGD,QAAaJ,KAAKC,QAC1BG,EAAOE,QAAQC,KAAK,IAI5B,GACF,EAIN,MAqKME,EAAsB,KACxBjB,KAAK,4BAIL,MAAMC,EAAOC,OAAOC,iBAAiB,gBAAiB,wBACtDC,YAAYC,OAAOJ,EAAM,CACrBK,QAAQC,GACJC,KAAKC,KAAO,+BAA+BF,EAAK,QAAQA,EAAK,GAAGW,aACpE,EACAP,QAAQC,GACJ,MAAMO,EAAUP,EAAOF,cACvB,GAAe,MAAXS,EAAiB,OACrB,MAAMC,EAAW,GAAGZ,KAAKC,YAAYU,KAErC,GAAIA,EAAQrB,SAAS,eACdqB,EAAQrB,SAAS,cACjBqB,EAAQrB,SAAS,YACtB,CACEe,KAAKO,GACL,MAAMC,EAAUF,EACXL,QAAQ,aAAc,OACtBA,QAAQ,YAAa,OACrBA,QAAQ,WAAY,OAKzB,OAJAF,EAAOE,QAAQQ,OAAOC,gBAAgBF,SACtCrB,KAAK,iBACDwB,OAAOC,UAAUjB,KAAKkB,QAASC,WAAWC,UACrCC,IAAIC,YAAYC,aAAaC,KAAK,MAAQ,K,CAG3D,GACF,EAIAC,EAAkB,KACpBjC,KAAK,mBAEL,MAAMkC,EAAwBC,KAAKC,QAAuB,cAAE,iBACtDC,EAAWH,EAAsBI,eACvCJ,EAAsBI,eAAiBH,KAAKI,UAAUL,GAClD,SAAUM,EAAOC,EAAUC,GAEvB,MAAMjC,EAAO,gBAAgB,IAAI0B,KAAKQ,OAAOH,OAAWL,KAAKS,iBAAiBH,OAAc,IAAIN,KAAKQ,OAAOD,OAC5G,IAAI9B,EAASyB,EAASG,EAAOC,EAAUC,GAOvC,OANIjC,EAAKX,SAAS,UAAYW,EAAKX,SAAS,YACxCe,KAAK,GAAGD,QAAaH,KACrBG,EAAS,GAINA,CACX,GAAE,EAGJiC,EAAqB,KACvB7C,KAAK,sBAEL,MAAM8C,EAAWX,KAAKC,QAAQW,MAAMC,eAC9BX,EAAWS,EAASR,eAC1BQ,EAASR,eAAiBH,KAAKI,UAAUO,GAAU,SAAUN,EAAOC,EAAUC,GAC1E,IAAIO,EAAoB,IAAId,KAAKQ,OAAOD,GAAWQ,WACnD,MAAMzC,EAAe,oBAAoBwC,OAOzC,OANIxC,EAAKX,SAAS,WACd4C,EAAYP,KAAKC,QAAQe,SAASC,kBAAkBH,EAAUnC,QAAQ,QAAS,QAC/ED,KAAK,GAAGJ,MAIL4B,EAASG,EAAOC,EAAUC,EACrC,GAAE,EAGAW,EAAqB,KACvBrD,KAAK,sBAEL,MAAMsD,EAAiB,CACnB,yBACA,iDACA,YACA,WACA,uBACA,yBACA,6BACA,gCACA,iBACA,mCACA,UACA,mBACA,uBACA,+BACA,gCACA,+CACA,qBACA,2BACA,sBACA,yBACA,mBACA,yBACA,4BACA,+DACA,gEACA,oDACA,gCACA,yDACA,4DACA,2BACA,2BACA,8BACA,kCACA,mCACA,qBACA,wBACA,2BACA,4BACA,UACA,eACA,gBACA,iBACA,iBACA,kBACA,sBAKER,EAAWX,KAAKC,QAAQmB,cAAc,mCACtClB,EAAWS,EAASR,eAC1BQ,EAASR,eAAiBH,KAAKI,UAAUO,GAAU,SAAUN,EAAOC,EAAUe,EAAkBC,GAC5F,IAAKD,EAAkB,OAAOnB,EAASG,EAAOC,EAAUe,EAAkBC,GAC1E,MAAMR,EAAoB,IAAId,KAAKQ,OAAOa,GAAkBN,WACtDzC,EAAe,oCAAoCwC,OAAeQ,MACxE,OAAIH,EAAexD,SAASmD,IACxBpC,KAAK,GAAGJ,KAED,GAIJ4B,EAASG,EAAOC,EAAUe,EAAkBC,EACvD,IAIArD,YAAYC,OAAOH,OAAOC,iBAAiB,oBAAqB,SAAW,CACvEG,QAAQC,GACJ,MAAMmD,EAAWnD,EAAK,GAAGG,cACzB,GAAgB,MAAZgD,EAAkB,CAClB,MAAMjD,EAAO,WAAWiD,MACpBJ,EAAexD,SAAS4D,KACxB7C,KAAK,GAAGJ,KACRF,EAAK,GAAKe,OAAOC,gBAAgB,Q,CAK7C,GACF,EAGAoC,EAAc,KAChB3D,KAAK,eAILI,YAAYC,OAAOH,OAAOC,iBAAiB,oBAAqB,UAAY,CACxEG,QAAQC,GACJC,KAAKoD,QAAUrD,EAAK,GAAGG,aAC3B,EACAC,QAAQC,GACJ,MAAMH,EAAO,YAAYD,KAAKoD,qBAAqBhD,EAAOF,iBACtC,MAAhBF,KAAKoD,SAAmC,yBAAhBpD,KAAKoD,UAC7B/C,KAAK,GAAGJ,KACRG,EAAOE,QAAQ+C,MACf7D,KAAK,iBACDwB,OAAOC,UAAUjB,KAAKkB,QAASC,WAAWC,UACrCC,IAAIC,YAAYC,aAAaC,KAAK,MAAQ,MAI3D,GACF,EAGA8B,EAAc,KAChB9D,KAAK,eAmBL,MACMC,EAAOC,OAAOC,iBAAiB,yBAA0B,UACzD4D,EAAU,IAAIC,eAAe/D,EAAM,MAAO,CAAC,MAAO,MAAO,UAAW,QAC1EG,YAAY6D,OAAOhE,GACnBG,YAAYU,QAAQb,EAAM,IAAIiE,gBAAe,CAACC,EAASC,EAAKnE,EAAMoE,KAC9DxD,KAAK,kBAAkBsD,MAAYC,MAAQnE,MAASoE,OALjC,IAMfF,EAAkC,EAC/BJ,EAAQI,EAASC,EAAKnE,EAAMoE,KACpC,MAAO,CAAC,MAAO,MAAO,UAAW,QAAQ,EAG1CC,EAAyB,KAC3BtE,KAAK,0BAGL,MAAMuE,EAAa,CACf,iBAIJnE,YAAYC,OAAOH,OAAOC,iBAAiB,aAAc,qBAAuB,CAC5EG,QAAQC,GAEJ,IAEIC,KAAKgE,UAAY,IAAIrC,KAAKQ,OAAOpC,EAAK,IAAI2C,U,CAC5C,MAAOuB,GACLjE,KAAKgE,UAAY,E,CAEzB,EACA7D,QAAQC,GACA2D,EAAWzE,SAASU,KAAKgE,aACzB3D,KAAK,GAAGD,4BAAiCJ,KAAKgE,gBAC9C5D,EAAOE,QAAQ+C,MAIvB,GACF,EAoBNa,WAAWC,gBAAkB,KACzB5E,YAGAkB,IACAgB,IACAY,IACAQ,IACAM,IACAG,IACAQ,GAAwB,EAG5BI,WAAW3E,UAAYA,UACvB2E,WAAWE,8BAzb2B,KAClC5E,KAAK,iCACL,MAAMC,EAAOc,IAAIoB,KAAKC,QAAkB,SAAE,sBAAsBE,gBAChElC,YAAYC,OAAOJ,EAAM,CACrBK,QAAQC,GACJsE,KAAK,8BACL,IAAIC,EAAO,IAAI3C,KAAKQ,OAAOpC,EAAK,IAC5BwE,EAAM5C,KAAKS,iBAAiBrC,EAAK,IACjCZ,EAAM,IAAIwC,KAAKQ,OAAOpC,EAAK,IAAI2C,WACnC1C,KAAKC,KAAO,GAAGqE,KAAQC,KAAOpF,GAClC,EACAgB,QAAQC,GACAlB,EAAsBc,KAAKC,OAC3BI,KAAK,GAAGD,QAAaJ,KAAKC,OAIlC,GACF,EAwaNiE,WAAWM,gBAxWa,KACpBhF,KAAK,4BAEL,IAAIiF,EAAc/E,OAAOC,iBAAiB,oBAAqB,UAc/DC,YAAYC,OAAO4E,EAAa,CAC5B3E,QAAQC,GAGJC,KAAKC,KAAO,YAAYF,EAAK,eAAeA,EAAK,YAAYA,EAAK,eAAeA,EAAK,YAAYA,EAAK,aAAaA,EAAK,OACzH,IAAI2E,EAAc,GAClB,IAAK,IAAIC,EAAI,EAAGA,EAAI5E,EAAK,GAAGW,UAAWiE,IAInCD,GAAO,GAAG,CAAC3E,EAAK,GAAG6E,IAAID,GAAGE,WAAWnC,gBAGzC1C,KAAK8E,MAAQJ,EAAIK,UAAU,EAAGL,EAAIM,OAAS,GAC3ChF,KAAKiF,KAAOlF,EAAK,EACrB,EACAI,QAAQC,GACJZ,KAAK,GAAGY,QAAaJ,KAAKC,QAC1BiF,KAAK,KAAKlF,KAAK8E,SAoCf,IAAIK,EAAc5E,IAAIP,KAAKiF,MAAML,IAA0B,EAAtBQ,QAAQC,aAC7CH,KAAK,KAAKC,QAAkBA,EAAYG,iBACZ,KAAxBH,EAAYN,YACZxE,KAAK,sBACL8E,EAAYI,aAAaJ,EAAYG,cAAcE,KAAI,OAE/D,GACF,EA2RNtB,WAAWzD,oBAAsBA,EACjCyD,WAAWzC,gBAAkBA,EAC7ByC,WAAW7B,mBAAqBA,EAChC6B,WAAWrB,mBAAqBA,EAChCqB,WAAWf,YAAcA,EACzBe,WAAWZ,YAAcA,EACzBY,WAAWJ,uBAAyBA,EAEpCI,WAAWuB,UAAY,KACnB7F,YAAYC,OAAOH,OAAOC,iBAAiB,KAAM,QAAU,CACvDG,QAAQC,GACJ,MAAMkB,EAAYD,OAAOC,UAAUjB,KAAKkB,QAASC,WAAWC,UAAUC,IAAIC,YAAYC,aAAaC,KAAK,QACxGkE,QAAQC,KAAK,4CACbD,QAAQE,IAAI3E,GACZyE,QAAQC,KAAK,yCACjB,GACF,EAGNzB,WAAW2B,YAAc,KACrBjG,YAAYC,OAAOH,OAAOC,iBAAiB,KAAM,UAAY,CACzDG,QAAQC,GACJ,MAAM+F,EAAO/F,EAAK,GAAGG,cACf6F,EAAOhG,EAAK,GAAGG,cACrBV,KAAK,YAAYsG,MAASC,MAC9B,GACF","ignoreList":[]}
âœ„
const t=t=>["/Applications/Cydia.app","/usr/sbin/sshd","/bin/bash","/etc/apt","/Library/MobileSubstrate","/User/Applications/","/private/var/lib/apt/","/private/var/lib/cydia/","substitute","substrate","CepheiUI"].some((e=>t.includes(e)));export const hook_stat=()=>{logd("hook stat & lstat");const e=Module.findExportByName("libsystem_kernel.dylib","stat");Interceptor.attach(e,{onEnter(t){this.disp=`stat ( '${t[0].readCString()}', ${t[1]} )`},onLeave(e){t(this.disp)&&(loge(`${e} <= ${this.disp}`),e.replace(ptr(-1)))}});const i=Module.findExportByName("libsystem_kernel.dylib","lstat");Interceptor.attach(i,{onEnter(t){this.disp=`lstat ( '${t[0].readCString()}', ${t[1]} )`},onLeave(e){t(this.disp)&&(loge(`${e} <= ${this.disp}`),e.replace(ptr(-1)))}})};const e=()=>{logd("hook dyld_get_image_name");const t=Module.findExportByName("libdyld.dylib","_dyld_get_image_name");Interceptor.attach(t,{onEnter(t){this.disp=`dyld_get_image_name ( index=${t[0]} | ${t[0].toInt32()} )`},onLeave(t){const e=t.readCString();if(null==e)return;const i=`${this.disp} => '${e}'`;if(e.includes("substitute")||e.includes("substrate")||e.includes("CepheiUI")){loge(i);const n=e.replace("substitute","---").replace("substrate","---").replace("CepheiUI","---");return t.replace(Memory.allocUtf8String(n)),void logd("called from:\n"+Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n")+"\n")}}})},i=()=>{logd("hook canOpenURL");const t=ObjC.classes.UIApplication["- canOpenURL:"],e=t.implementation;t.implementation=ObjC.implement(t,(function(t,i,n){const a=`canOpenURL ( ${new ObjC.Object(t)}, ${ObjC.selectorAsString(i)}, ${new ObjC.Object(n)} )`;let o=e(t,i,n);return(a.includes("cydia")||a.includes("Cydia"))&&(loge(`${o} <= ${a}`),o=0),o}))},n=()=>{logd("hook URLWithString");const t=ObjC.classes.NSURL.URLWithString_,e=t.implementation;t.implementation=ObjC.implement(t,(function(t,i,n){let a=new ObjC.Object(n).toString();const o=`URLWithString ( '${a}' )`;return o.includes("cydia")&&(n=ObjC.classes.NSString.stringWithString_(a.replace("cydia","ccc")),loge(`${o}`)),e(t,i,n)}))},a=()=>{logd("hook NSFileManager");const t=["/Application/Cydia.app","/Library/MobileSubstrate/MobileSubstrate.dylib","/bin/bash","/etc/apt","/private/var/lib/apt","/private/var/lib/cydia","/private/var/tmp/cydia.log","/Applications/WinterBoard.app","/var/lib/cydia","/private/etc/dpkg/origins/debian","/bin.sh","/private/etc/apt","/etc/ssh/sshd_config","/private/etc/ssh/sshd_config","/Applications/SBSetttings.app","/private/var/mobileLibrary/SBSettingsThemes/","/private/var/stash","/usr/libexec/sftp-server","/usr/libexec/cydia/","/usr/sbin/frida-server","/usr/bin/cycript","/usr/local/bin/cycript","/usr/lib/libcycript.dylib","/System/Library/LaunchDaemons/com.saurik.Cydia.Startup.plist","/System/Library/LaunchDaemons/com.saurik.Cy@dia.Startup.plist","/System/Library/LaunchDaemons/com.ikey.bbot.plist","/Applications/FakeCarrier.app","/Library/MobileSubstrate/DynamicLibraries/Veency.plist","/Library/MobileSubstrate/DynamicLibraries/LiveClock.plist","/usr/libexec/ssh-keysign","/usr/libexec/sftp-server","/Applications/blackra1n.app","/Applications/IntelliScreen.app","/Applications/Snoop-itConfig.app","/var/lib/dpkg/info","/Applications/Icy.app","/Applications/MxTube.app","/Applications/RockApp.app","/bin/sh","/usr/bin/ssh","/usr/bin/sshd","/usr/sbin/sshd","/var/cache/apt","/var/log/syslog","/var/tmp/cydia.log"],e=ObjC.classes.NSFileManager["- fileExistsAtPath:isDirectory:"],i=e.implementation;e.implementation=ObjC.implement(e,(function(e,n,a,o){if(!a)return i(e,n,a,o);const s=new ObjC.Object(a).toString(),r=`fileExistsAtPath:isDirectory: ( '${s}', ${o} )`;return t.includes(s)?(loge(`${r}`),0):i(e,n,a,o)})),Interceptor.attach(Module.findExportByName("libsystem_c.dylib","fopen"),{onEnter(e){const i=e[0].readCString();if(null!=i){const n=`fopen ( ${i} )`;t.includes(i)&&(loge(`${n}`),e[0]=Memory.allocUtf8String("zzzz"))}}})},o=()=>{logd("hook getenv"),Interceptor.attach(Module.findExportByName("libsystem_c.dylib","getenv"),{onEnter(t){this.envName=t[0].readCString()},onLeave(t){const e=`getenv ( ${this.envName} ) | ret: '${t.readCString()}'`;null!=this.envName&&"DYLD_INSERT_LIBRARIES"==this.envName&&(loge(`${e}`),t.replace(NULL),logd("called from:\n"+Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n")+"\n"))}})},s=()=>{logd("hook ptrace");const t=Module.findExportByName("libsystem_kernel.dylib","ptrace"),e=new NativeFunction(t,"int",["int","int","pointer","int"]);Interceptor.revert(t),Interceptor.replace(t,new NativeCallback(((t,i,n,a)=>(loge(`called ptrace( ${t}, ${i}, ${n}, ${a} )`),31==t?0:e(t,i,n,a))),"int",["int","int","pointer","int"]))},r=()=>{logd("hook NSClassFromString");const t=["HBPreferences"];Interceptor.attach(Module.findExportByName("Foundation","NSClassFromString"),{onEnter(t){try{this.className=new ObjC.Object(t[0]).toString()}catch(t){this.className=""}},onLeave(e){t.includes(this.className)&&(loge(`${e} <= NSClassFromString( '${this.className}' )`),e.replace(NULL))}})};globalThis.hook_all_detect=()=>{hook_stat(),e(),i(),n(),a(),o(),s(),r()},globalThis.hook_stat=hook_stat,globalThis.hook_NSString_IsEqualToString=()=>{logd("hook NSString_IsEqualToString");const e=ptr(ObjC.classes.NSString["- isEqualToString:"].implementation);Interceptor.attach(e,{onEnter(t){logw("NSString - isEqualToString");let e=new ObjC.Object(t[0]),i=ObjC.selectorAsString(t[1]),n=new ObjC.Object(t[1]).toString();this.disp=`${e} ${i} ${n}`},onLeave(e){t(this.disp)&&loge(`${e} <= ${this.disp}`)}})},globalThis.hook_isDebugged=()=>{logd("hook sysctl | isDebugged");let t=Module.findExportByName("libsystem_c.dylib","sysctl");Interceptor.attach(t,{onEnter(t){this.disp=`  ( name=${t[0]}, namelen=${t[1]}, oldp=${t[2]}, oldlenp=${t[3]}, newp=${t[4]}, newlen${t[5]} )`;let e="";for(let i=0;i<t[1].toInt32();i++)e+=`${[t[0].add(i).readInt()].toString()} | `;this.disp1=e.substring(0,e.length-3),this.info=t[2]},onLeave(t){logd(`${t} <= ${this.disp}`),logz(`\t${this.disp1}`);let e=ptr(this.info).add(4*Process.pointerSize);logz(`\t${e} => ${e.readPointer()}`),2048&e.readInt()&&(loge("\t! bypass isDebug"),e.writePointer(e.readPointer().and(-2049)))}})},globalThis.hook_get_image_name=e,globalThis.hook_canOpenURL=i,globalThis.hook_URLWithString=n,globalThis.hook_NSFileManager=a,globalThis.hook_getenv=o,globalThis.hook_ptrace=s,globalThis.hook_NSClassFromString=r,globalThis.hook_exit=()=>{Interceptor.attach(Module.findExportByName(null,"exit"),{onEnter(t){const e=Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n\t");console.warn("\n[-] ======== Backtrace Start  ========"),console.log(e),console.warn("\n[-] ======== Backtrace End  ========")}})},globalThis.hook_strcmp=()=>{Interceptor.attach(Module.findExportByName(null,"strcmp"),{onEnter(t){const e=t[0].readCString(),i=t[1].readCString();logd(`strcmp ( ${e}, ${i} )`)}})};
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/jailbreak/","sources":["include.ts"],"mappings":"MAAO,kBACA,kBAEA,oBACA","ignoreList":[]}
âœ„
import"./jail.js";import"./enum.js";import"./thread.js";import"./hooks.js";
âœ„
{"version":3,"file":"jail.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/jailbreak/","sources":[],"mappings":"","ignoreList":[]}
âœ„
export{};
âœ„
{"version":3,"file":"thread.js","names":["globalThis","hook_thread","Interceptor","attach","Module","getExportByName","onEnter","args","backTrace","Thread","backtrace","this","context","Backtracer","ACCURATE","map","DebugSymbol","fromAddress","join","console","log","includes","loge","logd"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/jailbreak/","sources":["thread.ts"],"mappings":"AA6BAA,WAAWC,YA3BS,KAGhBC,YAAYC,OAAOC,OAAOC,gBAAgB,0BAA2B,kBAAkB,CACnFC,QAAS,SAASC,GACd,MAAMC,EAAY,iBACdC,OAAOC,UAAUC,KAAKC,QAASC,WAAWC,UACrCC,IAAIC,YAAYC,aAAaC,KAAK,MAAQ,KACnDC,QAAQC,IAAIZ,GACRA,EAAUa,SAAS,YACnBC,KAAK,6BAELC,KAAK,6BAETJ,QAAQC,IAAI,6BACZD,QAAQC,IAAI,cAAcb,EAAK,IAC/BY,QAAQC,IAAI,cAAcb,EAAK,IAC/BY,QAAQC,IAAI,cAAcb,EAAK,GACnC,GACF","ignoreList":[]}
âœ„
globalThis.hook_thread=()=>{Interceptor.attach(Module.getExportByName("libsystem_pthread.dylib","_pthread_start"),{onEnter:function(e){const o="called from:\n"+Thread.backtrace(this.context,Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join("\n")+"\n";console.log(o),o.includes("tersafe2")?loge("[!] _pthread_start called"):logd("[!] _pthread_start called"),console.log("[*] _pthread_start called"),console.log("[*] args[0]",e[0]),console.log("[*] args[1]",e[1]),console.log("[*] args[2]",e[2])}})};export{};
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/","sources":["include.ts"],"mappings":"MAAO,wBACA","ignoreList":[]}
âœ„
import"./oc/include.js";import"./swift/include.js";
âœ„
{"version":3,"file":"ViewController.js","names":["globalThis","hook_ViewController","Interceptor","attach","ObjC","classes","implementation","onEnter","args","instance","Object","logd","_storyboard","$ivars","_modalPresentationStyle","logz","hook_UIAlertController","title","msg","onLeave","retval","_actions","count","handle","action","this","ins","Block"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["ViewController.ts"],"mappings":"AAmIAA,WAAWC,oBAjIiB,KAMpBC,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,gDAAgDC,eAAgB,CAChHC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,mCAAmCF,UAAiB,IAAIL,KAAKM,OAAOF,EAAK,kBAAkBA,EAAK,kBAAkBA,EAAK,MAC5H,MAAMI,EAAcH,EAASI,OAAoB,YAC3CC,EAA0BL,EAASI,OAAgC,wBACzEE,KAAK,iBAAiBH,+BAAyCE,IACnE,IAIJZ,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,gDAAgDC,eAAgB,CAChHC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,mCAAmCF,UAAiB,IAAIL,KAAKM,OAAOF,EAAK,wBAAwBA,EAAK,kBAAkBA,EAAK,MAClI,MAAMI,EAAcH,EAASI,OAAoB,YAC3CC,EAA0BL,EAASI,OAAgC,wBACzEE,KAAK,iBAAiBH,+BAAyCE,IACnE,IASJZ,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,yCAAyCC,eAAgB,CACzGC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,gDAAgDF,gBAAuBD,EAAK,MACrF,IAIJN,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,+CAA+CC,eAAgB,CAC/GC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,sDAAsDF,kBAAyBD,EAAK,MAC7F,IAIJN,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,+CAA+CC,eAAgB,CAC/GC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,2CAA2CF,gBAAuBD,EAAK,mBAAmBA,EAAK,MACxG,IAYJN,YAAYC,OAAOC,KAAKC,QAA0B,iBAAE,qDAAqDC,eAAgB,CACrHC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IACtCG,KAAK,iDAAiDF,kBAAyBD,EAAK,mBAAmBA,EAAK,MAChH,G,EA6DZR,WAAWgB,uBAvDoB,KAG3Bd,YAAYC,OAAOC,KAAKC,QAA2B,kBAAE,sDAAsDC,eAAgB,CACvHC,QAAQC,GACJ,MAAMS,EAAQ,IAAIb,KAAKM,OAAOF,EAAK,IAC7BU,EAAM,IAAId,KAAKM,OAAOF,EAAK,IACjCG,KAAK,sCAAsCM,eAAmBC,qBAAuBV,EAAK,KAC9F,EAAGW,QAAQC,GACP,MAAMX,EAAwB,IAAIL,KAAKM,OAAOU,GACxCC,EAAWZ,EAASI,OAAiB,SACrCS,EAAQD,EAAS,aACvBN,KAAK,KAAKN,eAAsBY,EAASE,YAAYD,MACzD,IAIJpB,YAAYC,OAAOC,KAAKC,QAA2B,kBAAE,gBAAgBC,eAAgB,CACjFC,QAAQC,GACJ,MAAMC,EAAW,IAAIL,KAAKM,OAAOF,EAAK,IAChCgB,EAAS,IAAIpB,KAAKM,OAAOF,EAAK,IACpCG,KAAK,+BAA+BF,mBAA0Be,MAC9DC,KAAKC,IAAMjB,CACf,EAAGU,QAAQC,GACP,MAAMX,EAAWgB,KAAKC,IAChBL,EAAWZ,EAASI,OAAiB,SACrCS,EAAQD,EAAS,aACvBN,KAAK,KAAKN,eAAsBY,OAAcC,MAClD,IAIJpB,YAAYC,OAAOC,KAAKC,QAAuB,cAAE,oCAAoCC,eAAgB,CACjGC,QAAQC,GACJ,MAAMS,EAAQ,IAAIb,KAAKM,OAAOF,EAAK,IAEnCG,KAAK,2CAA2CM,aAAiBT,EAAK,gBAAgB,IAAIJ,KAAKuB,MAAMnB,EAAK,OAC9G,GACF","ignoreList":[]}
âœ„
globalThis.hook_ViewController=()=>{Interceptor.attach(ObjC.classes.UIViewController["- presentViewController:animated:completion:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled presentViewController:'${t}' -> '${new ObjC.Object(e[2])}' animated:'${e[3]}' completion:${e[4]}`);const n=t.$ivars._storyboard,o=t.$ivars._modalPresentationStyle;logz(`\t_storyboard:${n} | _modalPresentationStyle:${o}`)}}),Interceptor.attach(ObjC.classes.UIViewController["- presentViewController:animated:completion:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled presentViewController:'${t}' -> '${new ObjC.Object(e[2])}' withTransition:'${e[3]}' completion:${e[4]}`);const n=t.$ivars._storyboard,o=t.$ivars._modalPresentationStyle;logz(`\t_storyboard:${n} | _modalPresentationStyle:${o}`)}}),Interceptor.attach(ObjC.classes.UIViewController["- dismissModalViewControllerAnimated:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled dismissModalViewControllerAnimated:'${t}' animated:'${e[2]}'`)}}),Interceptor.attach(ObjC.classes.UIViewController["- dismissModalViewControllerWithTransition:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled dismissModalViewControllerWithTransition:'${t}' Transition:'${e[2]}'`)}}),Interceptor.attach(ObjC.classes.UIViewController["- dismissViewControllerAnimated:completion:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled dismissViewControllerAnimated:'${t}' Animated:'${e[2]}' completion:'${e[3]}'`)}}),Interceptor.attach(ObjC.classes.UIViewController["- dismissViewControllerWithTransition:completion:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]);logd(`\nCalled dismissViewControllerWithTransition:'${t}' Transition:'${e[2]}' completion:'${e[3]}'`)}})},globalThis.hook_UIAlertController=()=>{Interceptor.attach(ObjC.classes.UIAlertController["+ alertControllerWithTitle:message:preferredStyle:"].implementation,{onEnter(e){const t=new ObjC.Object(e[2]),n=new ObjC.Object(e[3]);logd(`\nCalled alertControllerWithTitle:'${t}' message:'${n}' preferredStyle:${e[4]}`)},onLeave(e){const t=new ObjC.Object(e),n=t.$ivars._actions,o=n["- count"]();logz(`\t${t} | actions:${n.handle} [ ${o} ]`)}}),Interceptor.attach(ObjC.classes.UIAlertController["- addAction:"].implementation,{onEnter(e){const t=new ObjC.Object(e[0]),n=new ObjC.Object(e[2]);logd(`\nCalled UIAlertController '${t}' - addAction:'${n}'`),this.ins=t},onLeave(e){const t=this.ins,n=t.$ivars._actions,o=n["- count"]();logz(`\t${t} | actions:${n} [ ${o} ]`)}}),Interceptor.attach(ObjC.classes.UIAlertAction["+ actionWithTitle:style:handler:"].implementation,{onEnter(e){const t=new ObjC.Object(e[2]);logd(`\nCalled UIAlertAction actionWithTitle:'${t}' style:'${e[3]}' handler:'${new ObjC.Block(e[4])}'`)}})};export{};
âœ„
{"version":3,"file":"button.js","names":["UIControlEvents","UIControlTargetAction","constructor","ptr","this","isa","NULL","_target","_action","_eventMask","UNDEF","_cancelled","readPointer","add","Process","pointerSize","readU32","readU8","_target_ins","ObjC","Object","_action_str","readCString","parseAction","_fullName","$methods","filter","i","includes","_action_method","$class","implementation","toString","globalThis","showButtonActions","mPtr","checkPointer","obj","getSuperClasses","map","$className","getFields","Error","classes","$ivars","actions","isNull","count","item_obj","item","handle","logd"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["button.ts"],"mappings":"AA4BA,IAAKA,GAAL,SAAKA,GACDA,IAAA,iBACAA,IAAA,mCACAA,IAAA,+CACAA,IAAA,+CACAA,IAAA,iDACAA,IAAA,8CACAA,IAAA,4CACAA,IAAA,4CACAA,IAAA,+CACAA,IAAA,yCACAA,IAAA,4CACAA,IAAA,gEACAA,IAAA,2DACAA,IAAA,mDACAA,IAAA,kDACAA,IAAA,gDACAA,IAAA,4DACAA,IAAA,gDACAA,IAAA,sDACAA,IAAA,+DACAA,IAAA,sDACAA,IAAA,2CACH,CAvBD,CAAKA,MAAe,KAgCpB,MAAMC,EAUFC,YAAmBC,GATXC,KAAAC,IAAqBC,KACrBF,KAAAG,QAAyBD,KACzBF,KAAAI,QAAyBF,KACzBF,KAAAK,WAA8BT,EAAgBU,MAC9CN,KAAAO,YAAsB,EAM1BP,KAAKC,IAAMF,EAAIS,cACfR,KAAKG,QAAUJ,EAAIU,IAAI,EAAIC,QAAQC,aAAaH,cAChDR,KAAKI,QAAUL,EAAIU,IAAI,EAAIC,QAAQC,aAAaH,cAChDR,KAAKK,WAAaN,EAAIU,IAAI,EAAIC,QAAQC,aAAaC,UACnDZ,KAAKO,WAA8D,GAAjDR,EAAIU,IAAI,EAAIC,QAAQC,YAAc,GAAGE,SAEvDb,KAAKc,YAAc,IAAIC,KAAKC,OAAOhB,KAAKG,SACxCH,KAAKiB,YAAcjB,KAAKI,QAAQc,aACpC,CAEOC,cACH,MAAMC,EAAYpB,KAAKc,YAAYO,SAASC,QAAOC,GAAKA,EAAEC,SAASxB,KAAKiB,eAAc,GAChFQ,EAAiBzB,KAAKc,YAAYY,OAAON,GAC/C,MAAO,GAAGrB,IAAI0B,SAAsBA,EAAeE,gBACvD,CAEAC,WACI,MAAO,WAAW5B,KAAKc,0BAA0Bd,KAAKI,cAAcJ,KAAKiB,kBAAkBjB,KAAKmB,+BAA+BnB,KAAKK,0BAA0BL,KAAKO,YACvK,EAsCJsB,WAAWC,kBAnCgB/B,IACvB,MAAMgC,EAAOC,aAAajC,GAC1B,IAAIkC,EAAM,IAAIlB,KAAKC,OAAOe,GAC1B,IAAKG,gBAAgBH,GAAMI,KAAIZ,GAAKA,EAAEa,aAAYZ,SAAS,YAAY,CAYnE,IAAIa,UAAUN,GAAMP,SAAS,WAGzB,MAAM,IAAIc,MAAM,6CAA0CvB,KAAKwB,QAAkB,gBAASN,KAF1FA,EAAMA,EAAIO,OAAgB,O,CAKlC,MAAMC,EAAUR,EAAIO,OAAuB,eAC3C,GAAIC,EAAQC,SAAU,MAAM,IAAIJ,MAAM,oBAAoBG,OAC1D,MAAME,EAAQF,EAAQ,aACtB,IAAK,IAAIlB,EAAI,EAAGA,EAAIoB,EAAOpB,IAAK,CAC5B,MAAMqB,EAAwBH,EAAQ,oBAAoBlB,GACpDsB,EAA8B,IAAIhD,EAAsB+C,EAASE,QACvEC,KAAK,IAAIxB,MAAMsB,I","ignoreList":[]}
âœ„
var t;!function(t){t[t.UNDEF=0]="UNDEF",t[t.EventTouchDown=1]="EventTouchDown",t[t.EventTouchDownRepeat=2]="EventTouchDownRepeat",t[t.EventTouchDragInside=4]="EventTouchDragInside",t[t.EventTouchDragOutside=8]="EventTouchDragOutside",t[t.EventTouchDragEnter=16]="EventTouchDragEnter",t[t.EventTouchDragExit=32]="EventTouchDragExit",t[t.EventTouchUpInside=64]="EventTouchUpInside",t[t.EventTouchUpOutside=128]="EventTouchUpOutside",t[t.EventTouchCancel=256]="EventTouchCancel",t[t.EventValueChanged=4096]="EventValueChanged",t[t.EventPrimaryActionTriggered=8192]="EventPrimaryActionTriggered",t[t.EventMenuActionTriggered=16384]="EventMenuActionTriggered",t[t.EventEditingDidBegin=65536]="EventEditingDidBegin",t[t.EventEditingChanged=131072]="EventEditingChanged",t[t.EventEditingDidEnd=262144]="EventEditingDidEnd",t[t.EventEditingDidEndOnExit=524288]="EventEditingDidEndOnExit",t[t.EventAllTouchEvents=4095]="EventAllTouchEvents",t[t.EventAllEditingEvents=983040]="EventAllEditingEvents",t[t.EventApplicationReserved=251658240]="EventApplicationReserved",t[t.EventSystemReserved=4026531840]="EventSystemReserved",t[t.EventAllEvents=4294967295]="EventAllEvents"}(t||(t={}));class e{constructor(e){this.isa=NULL,this._target=NULL,this._action=NULL,this._eventMask=t.UNDEF,this._cancelled=!1,this.isa=e.readPointer(),this._target=e.add(1*Process.pointerSize).readPointer(),this._action=e.add(2*Process.pointerSize).readPointer(),this._eventMask=e.add(3*Process.pointerSize).readU32(),this._cancelled=0!=e.add(3*Process.pointerSize+4).readU8(),this._target_ins=new ObjC.Object(this._target),this._action_str=this._action.readCString()}parseAction(){const t=this._target_ins.$methods.filter((t=>t.includes(this._action_str)))[0],e=this._target_ins.$class[t];return`${ptr(e)} -> ${e.implementation}`}toString(){return`target: ${this._target_ins}\n\taction: ${this._action} | '${this._action_str}' | ${this.parseAction()}\n\teventMask: ${this._eventMask}, cancelled: ${this._cancelled}`}}globalThis.showButtonActions=t=>{const n=checkPointer(t);let i=new ObjC.Object(n);if(!getSuperClasses(n).map((t=>t.$className)).includes("UIButton")){if(!getFields(n).includes("_button"))throw new Error(`pointer --//--\x3e class extends UIButton ${ObjC.classes.UIButton} ? C:${i}`);i=i.$ivars._button}const s=i.$ivars._targetActions;if(s.isNull())throw new Error(`targetActions == ${s} }`);const o=s["- count"]();for(let t=0;t<o;t++){const n=s["- objectAtIndex:"](t),i=new e(n.handle);logd(`[${t}] ${i}`)}};export{};
âœ„
{"version":3,"file":"clazz.js","names":["ObjCClassIMPL","ObjC","Object","constructor","mPtr","super","this","$kind","Error","name","$className","getName","toString","implementation","globalThis","Class"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["clazz.ts"],"mappings":"OAAM,MAAOA,sBAAsBC,KAAKC,OAEpCC,YAAYC,GAER,GADAC,MAAMD,GACY,cAAdE,KAAKC,MAAuB,MAAM,IAAIC,MAAM,4CAA4CF,KAAKC,QACrG,CAEIE,WACA,OAAOH,KAAKI,UAChB,CAEOC,UACH,OAAOL,KAAKI,UAChB,CAEOE,WACH,MAAO,MAAMN,KAAKO,kBAAkBP,MACxC,EAcJQ,WAAWb,KAAKc,MAAQf","ignoreList":[]}
âœ„
export class ObjCClassIMPL extends ObjC.Object{constructor(s){if(super(s),"meta-class"==this.$kind)throw new Error(`this ptr can not cast to class | current:${this.$kind}`)}get name(){return this.$className}getName(){return this.$className}toString(){return`C: ${this.implementation} ${this}`}}globalThis.ObjC.Class=ObjCClassIMPL;
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["include.ts"],"mappings":"MAAO,mBACA,oBACA,gBAEA,oBACA,4BAEA","ignoreList":[]}
âœ„
import"./clazz.js";import"./method.js";import"./oc.js";import"./button.js";import"./ViewController.js";import"./types/include.js";
âœ„
{"version":3,"file":"method.js","names":["ObjCMethodIMPL","ObjC","Object","toString","this","implementation","ptr","implememtation","globalThis","Method"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["method.ts"],"mappings":"OAAM,MAAOA,uBAAuBC,KAAKC,OAErCC,WACI,MAAO,MAAMC,KAAKC,kBAAkBD,MACxC,CAEIE,UACA,OAAOF,KAAKG,cAChB,EAcJC,WAAWP,KAAKQ,OAAST","ignoreList":[]}
âœ„
export class ObjCMethodIMPL extends ObjC.Object{toString(){return`C: ${this.implementation} ${this}`}get ptr(){return this.implememtation}}globalThis.ObjC.Method=ObjCMethodIMPL;
âœ„
{"version":3,"file":"oc.js","names":["cacheAllClass","globalThis","getCachedClasses","length","Object","values","ObjC","classes","findMethodsByResolver","query","Error","count","ApiResolver","enumerateMatches","forEach","m","logd","address","name","showMethods","clsNameOrPtr","filter","includeParent","obj","checkPointer","logw","$className","$class","handle","debugSym","DebugSymbol","fromAddress","md","Process","findModuleByName","moduleName","logz","path","ptr","size","error","showSuperClasses","$methods","$ownMethods","includes","sort","i1","i2","localeCompare","map","i","method","impl","implementation","findModuleByAddress","extraDes","String","sub","base","padEnd","selector","call","allocOCString","substring","indexOf","item","logn","findMethods","className","accurate","ItorClassMethods","cls","methods","a","b","newLine","findClasses","$moduleName","getSuperClasses","cls_itor","arr","isNull","$superClass","push","disp","showMethod","extName","localM","NULL","found","undefined","nameToMethod","logs","getLine","readCString","argsCount","toInt32","typeEncoding","rva","pk","getArgsAndRet","ret","parseType","args","index","packArgs","arg","type","toString","selectorAsString","Boolean","packArgsAndRet","dst_ptr","Memory","alloc","writeByteArray","Array","from","Uint8Array","typeStr","toDisplay","idByAlias","c","s","q","C","I","S","Q","f","d","B","v","fridaTypeExt","BOOL","object","block","class","startsWith","ret_case","getFields","localCls","ObjCls","fields","k","$ivars","lookupMethod","methodName","clz","sel","allocCString","printDictionary","dictionary","dis","NativePointer","keys","allKeys","key","objectAtIndex_","value","objectForKey_","printArray","array","loge","showSubClasses","cur","sup","equals"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/","sources":["oc.ts"],"mappings":"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","ignoreList":[]}
âœ„
var e=[];globalThis.cacheAllClass=e;const t=()=>(0===e.length&&(e=Object.values(ObjC.classes)),e);globalThis.findMethodsByResolver=e=>{if(null==e)throw new Error("query cannot be null");let t=0;new ApiResolver("objc").enumerateMatches(e).forEach((e=>logd(`[ ${t++} ]\t${e.address}\t${e.name}`)))};globalThis.showMethods=(e,t="",r=!1)=>{const o=new ObjC.Object(checkPointer(e));logw(`\nDisplay methods of ${o.$className} @ ${o.$class.handle}`);try{const e=DebugSymbol.fromAddress(o.$class.handle),t=Process.findModuleByName(e.moduleName);logz(`${e.name} IN ${e.moduleName} [ ${t?.path} ${ptr(t?.size)} ]`)}catch(e){}l(o);let s=0;(r?o.$methods:o.$ownMethods).filter((e=>0==t.length||e.includes(t))).sort(((e,t)=>t.localeCompare(e))).map(((e,t)=>{s=t;try{const l=o.$class[e],r=l.implementation,s=Process.findModuleByAddress(r);let n="-> ";try{n+=`${String(r.sub(s?.base)).padEnd(11," ")} `}catch(e){n=""}return`[ ${t} ]\t M: ${ptr(l)} -> ${r} ${n} | ${e}`}catch(l){const r=call("NSSelectorFromString",allocOCString(e.substring(e.indexOf(" ")+1))),s=call("class_getInstanceMethod",o,r),n=call("method_getImplementation",s),a=Process.findModuleByAddress(n);let c="-> ";try{c+=`${String(n.sub(a?.base)).padEnd(11," ")} `}catch(e){c=""}return`[ ${t} ]\t M: ${s} -> ${n} ${c}| ${e}`}})).forEach(((e,t)=>e.includes(" _")?logz(e):logd(e))),logn(`\n{ F:${s+1} / A:${o.$methods.length} }\n`)},globalThis.findMethods=(e,l,r=!1)=>{if(null==e)throw new Error("query cannot be null");let o=0;function s(e,t,l){const r=e.$methods.filter((e=>l?e==t:e.includes(t)));if(0==r.length)throw new Error(`class methods len = ${e.$methods} ... after Fileter ${r.length}`);logw(`\n[!] ${e.handle} | ${r.length} | ${e.$className} \n`),r.map(((t,l)=>{try{const r=e.$class[t],o=r.implementation,s=Process.findModuleByAddress(o);let n="-> ";try{n+=`${String(o.sub(s?.base)).padEnd(11," ")} `}catch(e){n=""}return`[ ${l} ]\t M: ${ptr(r)} -> ${o} ${n} | ${t}`}catch(r){const o=call("NSSelectorFromString",allocOCString(t.substring(t.indexOf(" ")+1))),s=call("class_getInstanceMethod",e,o),n=call("method_getImplementation",s),a=Process.findModuleByAddress(n);let c="-> ";try{c+=`${String(n.sub(a?.base)).padEnd(11," ")} `}catch(e){c=""}return`[ ${l} ]\t M: ${s} -> ${n} ${c} | ${t}`}})).sort(((e,t)=>t[0].localeCompare(e[0]))).map((e=>`[ ${o++} ]\t${e}`)).forEach(logd)}l?s(ObjC.classes[l],e,r):t().forEach((t=>s(t,e,r))),newLine()},globalThis.findClasses=(e,l=!1)=>{if(null==e)throw new Error("query cannot be null");newLine();let r=0;t().filter((t=>l?t.$className==e:t.$className.includes(e))).forEach((e=>{logd(`[ ${r++} ]\t${e.$class.handle}  ${e.$className}`);const t=Process.findModuleByName(e.$moduleName);logz(`\t${t?.base} ${ptr(t?.size)} \t ${e.$moduleName}`)})),newLine()},globalThis.getSuperClasses=e=>{let t=new ObjC.Object(checkPointer(e)),l=[t];for(;;)try{if(t.isNull()||t.handle.isNull())break;t=t.$superClass,null!=t&&l.push(t)}catch(e){break}return l};const l=e=>{const t=getSuperClasses(checkPointer(e));let l="";try{for(let e=0;e<t.length;e++)l+=t[e].$className,l+=` ( ${t[e].$class.handle} ) `,e<t.length-1&&(l+=" -> ")}catch(e){}logd(`\n${l}\n`)};globalThis.m=globalThis.showMethods,globalThis.showMethod=(e,t)=>{let l=NULL;try{l=checkPointer(e)}catch(t){if("string"==typeof e){let t;if(t=e.includes("[")?new ApiResolver("objc").enumerateMatches(e):new ApiResolver("objc").enumerateMatches(`*[* ${e}]`),null==t||null==t||0==t.length)throw new Error(`Not Found -> ${e}`);return void t.forEach((e=>showMethod(nameToMethod(e.name).handle,e.name)))}throw t}logs(getLine(60,"-"));const r=call("method_getName",l).readCString();logd(`Name\t\t\t->\t${r} ${null==t?"":` | ${t}`}`);const o=call("method_getNumberOfArguments",l).toInt32();logd(`NumberOfArguments\t->\t${o}`);const s=call("method_getTypeEncoding",l).readCString();logd(`TypeEncoding\t\t->\t${s}`),logd(`ObjectMethod\t\t->\t${l}`);const n=call("method_getImplementation",l);let a;try{const e=Process.findModuleByAddress(n);let t="";t=`${n.sub(e.base)}`,a=`| ${t} `,logd(`Implementation\t\t->\t${n} ${a}`)}catch(e){a="",logz(`Implementation\t\t->\t${n} ${a}`)}const c=getArgsAndRet(l);logd("ReturnType"),logd(`\tret: \t\t${c.ret} - ${parseType(c.ret)}`),logd("ArgumentTypes"),c.args.forEach(((e,t)=>logd(`\targs[${t}]:\t${e} - ${parseType(e)}`)))};export const packArgs=(e,t)=>{switch(t){case"string":return null==e.readCString()?"":e.readCString();case"class":case"object":return new ObjC.Object(e).toString();case"selector":return ObjC.selectorAsString(e);case"bool":return`${e} => ${new Boolean(e).toString()}`;default:return`${e}`}};export const getArgsAndRet=e=>{let t={ret:"",args:[]};const l=Memory.alloc(32);call("method_getReturnType",e,l,32);const r=l.readCString();t.ret=r,l.writeByteArray(Array.from(new Uint8Array(32)));for(let r=0;r<call("method_getNumberOfArguments",e).toInt32();r++)try{l.writeByteArray(Array.from(new Uint8Array(32))),call("method_getArgumentType",e,r,l,32),t.args[r]=l.readCString()}catch(e){if(0!=r)throw e;t.args[0]="@"}return t};export const parseType=(e,t=!0)=>{const l={c:"char",i:"int",s:"int16",q:"int64",C:"uchar",I:"uint",S:"uint16",Q:"uint64",f:"float",d:"double",B:"bool",b:"bool",v:"void","*":"string","@":"object","@?":"block","#":"class",":":"selector","^v":"pointer"},r={BOOL:"bool",object:"pointer",block:"pointer",class:"pointer",selector:"pointer"};if(null==e||null==e)return"";if(t)return e in l?l[e]:e.startsWith("{")?"struct":`${e} <- parse error`;if(e in l){const t=l[e],o=r[t];return o??t}return"pointer"};globalThis.getFields=e=>{const t=checkPointer(e),l=new ObjC.Object(t);let r=new Array;for(const e in l.$ivars)r.push(e);return r};globalThis.f=e=>getFields(e).forEach(logd),globalThis.lookupMethod=(e,t)=>{try{const l=call("NSClassFromString",allocOCString(e));if(l.isNull())throw new Error(`class ${e} not found`);const r=call("NSSelectorFromString",allocOCString(t));if(r.isNull())throw new Error(`error: get selector ${t}`);const o=call("class_lookupMethod",l,r);if(o.isNull())throw new Error(`class ${e} method ${t} not found`);return o}catch(l){const r=call("objc_getClass",allocCString(e));if(r.isNull())throw new Error(`class ${e} not found`);const o=call("NSSelectorFromString",allocOCString(t));if(o.isNull())throw new Error(`error: get selector ${t}`);const s=call("class_getMethodImplementation",r,o);if(s.isNull())throw new Error(`class ${e} method ${t} not found`);return s}};globalThis.printDictionary=e=>{let t;if(e instanceof NativePointer)t=new ObjC.Object(e);else{if(!(e instanceof ObjC.Object))throw new Error("Error dictionary(args[0]), Need ObjC.Object or NativePointer");t=e}const l=t.allKeys();for(let e=0;e<l.count();e++){const r=l.objectAtIndex_(e),o=t.objectForKey_(r);logd(`Key: ${r.toString()}, Value: ${o.toString()}`)}},globalThis.printArray=e=>{let t;if(e instanceof NativePointer)t=new ObjC.Object(e);else{if(!(e instanceof ObjC.Object))throw new Error("Error array(args[0]), Need ObjC.Object or NativePointer");t=e}const l=t.count();0==l&&loge("Null array");for(let e=0;e<l;e++){const l=t.objectAtIndex_(e);logd(`Index: ${e}, Value: ${l.toString()}`)}},globalThis.showSuperClasses=l,globalThis.getSuperClasses=getSuperClasses,globalThis.showSubClasses=e=>{const l=new ObjC.Object(checkPointer(e));logw(`\nDisplay sub classes of ${l.$className} @ ${l.$class.handle} \n`),t().filter((e=>{const t=e.$superClass;return null!=t&&null!=t&&t.equals(l.$class)})).sort(((e,t)=>e.$className.localeCompare(t.$className))).forEach(((e,t)=>{const l=`[ ${t} ]\t${e.$class.handle} -> ${e.$className}`;e.$className.startsWith("_")?logz(l):logd(l)})),newLine()};
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/types/","sources":["include.ts"],"mappings":"MAAO","ignoreList":[]}
âœ„
import"./objc_method.js";
âœ„
{"version":3,"file":"objc_method.js","names":["getArgsAndRet","packArgs","parseType","HK_TYPE","OC_Hook_Status_IMPL","static","oldPtr_","_key","value","OC_Hook_Status","mapSrcToNewImpl","oldPtr","equals","newPtr","NULL","objcMethod","get","set","key","_value","handle","index","newLine","logd","Map","objc_method_local","constructor","mPtr","methodName","this","PTR_SEL","PTR_TYPES","PTR_IMPL","localP","undefined","NativePointer","trim","startsWith","Error","ptr","impl","add","Process","pointerSize","readPointer","methodFHandle","addressToMethod","error","ObjC","classes","address","rva","md","findModuleByAddress","sub","base","sel_ptr","sel","selectorAsString","types","readCString","argsCount","argumentTypes","length","call","toInt32","toString","HookType","OBJC_REP","hook","hooktype","passPrivate","defaultArgsC","force","logw","includes","FRIDA_ATTACH","A","args","argsStr","Array","from","_","i","join","count","loge","FRIDA_REP","argsT","eval","map","_i","srcCall","NativeFunction","Interceptor","revert","logz","replace","NativeCallback","ret","arguments","c","il","Object","method","old_impl","implementation","new_impl","implement","clazz","selector","_c","pk","retType","extInfo","retObj","$kind","$className","$class","typeName","obj","addNew","logg","detachOC","globalThis","objc_method"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/oc/types/","sources":["objc_method.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{getArgsAndRet,packArgs,parseType}from"../oc.js";import{HK_TYPE}from"../../../../utils.js";export class OC_Hook_Status_IMPL{static getNewImplFromOld(t){for(const[e,o]of OC_Hook_Status.mapSrcToNewImpl)if(o.oldPtr.equals(t))return o.newPtr;return NULL}static getNewImplFromOCMethod(t){return OC_Hook_Status.mapSrcToNewImpl.get(t)?.oldPtr}static addNew(t,e,o){OC_Hook_Status.mapSrcToNewImpl.set(t,{newPtr:e,oldPtr:o})}static has(t){for(const[e,o]of OC_Hook_Status.mapSrcToNewImpl)if(e.handle==t)return!0;return!1}static disp(){let t=0;newLine();for(const[e,o]of OC_Hook_Status.mapSrcToNewImpl){logd(`[${t++}] \tobjcMethod:${e.handle} => { newPtr:${o.newPtr}, oldPtr:${o.oldPtr} }`)}newLine()}}OC_Hook_Status_IMPL.mapSrcToNewImpl=new Map;class objc_method_local{constructor(t,e){this.PTR_SEL=NULL,this.PTR_TYPES=NULL,this.PTR_IMPL=NULL;let o=NULL;if(null!=t&&null==e){if(!(t instanceof NativePointer||"number"==typeof t||"string"==typeof t&&t.trim().startsWith("0x")))throw new Error("Invalid argument");o=t instanceof NativePointer?t:ptr(t);try{const t=o.add(2*Process.pointerSize).readPointer();this.methodFHandle=addressToMethod(t)}catch(t){}}else{if(null==e||"string"!=typeof t)throw new Error("Invalid argument");this.methodFHandle=ObjC.classes[t][e],o=this.methodFHandle.handle}this.PTR_SEL=o,this.PTR_TYPES=o.add(Process.pointerSize),this.PTR_IMPL=o.add(2*Process.pointerSize)}get address(){return this.PTR_IMPL.readPointer()}get rva(){const t=Process.findModuleByAddress(this.address);return this.address.sub(t?.base)}get sel_ptr(){return this.PTR_SEL.readPointer()}get sel(){return ObjC.selectorAsString(this.sel_ptr)}get types(){return this.methodFHandle?this.methodFHandle.types:this.PTR_TYPES.readPointer().readCString()}get argsCount(){return this.methodFHandle?this.methodFHandle.argumentTypes.length:call("method_getNumberOfArguments",this.PTR_SEL).toInt32()}toString(){return`${this.PTR_SEL} -> ${this.address} -> ${this.rva} | ${this.sel} (${this.types})`}get HookType(){return HK_TYPE.OBJC_REP}hook(hooktype=this.HookType,passPrivate=!0,defaultArgsC=6,force=!1){if(!force){if(passPrivate&&this.sel.startsWith("_"))return void logw(`hooking ${this.address} -> ${this.sel} | pass private method`);if(this.sel.includes("alloc")||this.sel.includes("description"))return void logw(`hooking ${this.address} -> ${this.sel} | pass filter method`)}switch(hooktype){case HK_TYPE.FRIDA_ATTACH:const argsCount=this.argsCount;try{A(this.address,(t=>{const e=Array.from({length:argsCount},((e,o)=>t[o].toString())).join(", ");logd(`[ ${++objc_method_local.count} ]\tcalled ${e}`)})),logd(`hooking ${this.address} -> ${this.sel}`)}catch(t){loge(`hooking ${this.address} -> ${this.sel} | Error: ${t}`)}break;case HK_TYPE.FRIDA_REP:let argsT;argsT=this.methodFHandle?eval(`[ ${this.methodFHandle?.argumentTypes.map((t=>`"${t}"`))} ]`):eval(`[ ${Array.from({length:defaultArgsC},((t,e)=>'"pointer"')).join(", ")} ]`);try{const t=new NativeFunction(this.address,"pointer",argsT);Interceptor.revert(this.address),logz(`${this.sel} ${argsT}`),Interceptor.replace(this.address,new NativeCallback((function(...e){let o=t(...arguments);const s=e.map(((t,e)=>{const o=t;return 0==e?`${new ObjC.Object(o)} @ ${o}`:1==e?ObjC.selectorAsString(o):ptr(t)})).join(", ");return logd(`[ ${++objc_method_local.count} ]\tcalled ${s}`),o}),"pointer",argsT)),logd(`hooking ${this.address} -> ${this.sel}`)}catch(t){loge(`hooking ${this.address} -> ${this.sel} | Error: ${t}`)}break;case HK_TYPE.OBJC_REP:const method=this.methodFHandle;if(null==method)return loge(`${this.address} -> ${this.sel} | Error: already replaced`);const old_impl=method.implementation;try{const t=ObjC.implement(method,(function(t,e,...o){const s=old_impl(t,e,...o),r=o.map(((t,e)=>t)).join(", "),a=getArgsAndRet(method.handle);logd(`[ ${++objc_method_local.count} ]\tcalled ${new ObjC.Object(t)} @ ${t}, ${ObjC.selectorAsString(e)} ${r}`);const n=parseType(a.ret);if("void"!=n){let t=n;if("object"==n){const e=new ObjC.Object(s);t=`${e.$kind} of ${e.$className} @ ${e.$class.handle}`}logz(`retval  ${t}\t${packArgs(s,n)}`)}for(let t=0;t<a.args.length-2;t++)try{const e=parseType(a.args[t+2]);let s=e;if("object"==e){const e=new ObjC.Object(o[t]);s=`{ ${e.$kind} of ${e.$className} @ ${e.$class.handle} }`}logz(`args[${t}] ${s}\t${packArgs(o[t],e)}`)}catch(t){loge(t)}return s}));method.implementation=t,OC_Hook_Status.addNew(method,t,old_impl),logg(`hooking objM:${method.handle} ptr:${old_impl} new:${t} -> ${this.sel}`)}catch(t){loge(`hooking objM:${method.handle} ptr:${old_impl} -> ${this.sel} \nError: ${t}`)}break;default:throw new Error("ERROR HookType")}}detachOC(){}}objc_method_local.count=0,globalThis.objc_method=objc_method_local,globalThis.OC_Hook_Status=OC_Hook_Status_IMPL;
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/swift/","sources":["include.ts"],"mappings":"MAAO","ignoreList":[]}
âœ„
import"./main.js";
âœ„
{"version":3,"file":"main.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/lang/swift/","sources":[],"mappings":"","ignoreList":[]}
âœ„
export{};
âœ„
{"version":3,"file":"findsvc.js","names":["targetPointers","Array","globalThis","findSvcInstructions","md","Process","findModuleByName","mainModule","enumerateSections","forEach","item","name","logw","address","ptr","size","Memory","scanSync","index","logd","sub","base","DebugSymbol","fromAddress","includes","push","lastIns","currentIns","Instruction","parse","itorAdd","maxItor","insLog","mnemonic","operands","find","i","type","value","opCode","Number","SYSCALL","error","split","msg","logz","newLine","findBRKInstructions","registerFlag","nopSysCall","nopAll","patchCode","addr","arch","SYS_exit","SYS_ptrace","Arm64Writer","putNop","Interceptor","attach","onEnter","args","modTargets","setExceptionHandler","callback","loge","ins_value","readU32","writeU32","xor","toUInt32","length","ins"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/memory/","sources":["findsvc.ts"],"mappings":"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","ignoreList":[]}
âœ„
var S=new Array;globalThis.findSvcInstructions=(_="")=>{(""!=_?Process.findModuleByName(_):Process.mainModule).enumerateSections().forEach((_=>{"__text"==_.name&&(logw(`\n${_.address} -> ${_.name} ${ptr(_.size)}\n`),Memory.scanSync(_.address,_.size,"01 10 00 D4").forEach(((_,e)=>{logd(`[${e}] ->\t${_.address.sub(Process.mainModule.base)} | ${DebugSymbol.fromAddress(_.address)}`),S.includes(_.address)||S.push(_.address);let t,Y=Instruction.parse(_.address),s=_.address,n=5,a=`\n\t${Y.address} ${Y}`;try{for(;(s=s.sub(4))&&--n>0;){if(t=Instruction.parse(s),"mov"==t.mnemonic&&t.operands.find((S=>"reg"==S.type&&("w16"==S.value||"x16"==S.value)))){let S=Number(t.operands.find((S=>"imm"==S.type))?.value);a=`\n\t${t.address} ${t} | { ${SYSCALL[S]} [ ${S} ] `+a;break}a=`\n\t${t.address} ${t}`+a}}catch(S){}a.includes("| { ")||(a="\n\t ......"+a),a.split("\n").forEach((S=>S.includes("svc")||S.includes("| { ")?logw(S.includes("svc")?S+"\n":S):logz(S)))})),newLine())}))},globalThis.findBRKInstructions=(S="")=>{(""!=S?Process.findModuleByName(S):Process.mainModule).enumerateSections().forEach((S=>{"__text"==S.name&&(logw(`\n${S.address} -> ${S.name} ${ptr(S.size)}\n`),Memory.scanSync(S.address,S.size,"20 00 20 D4").forEach(((S,_)=>{logd(`[${_}] ->\t${S.address.sub(Process.mainModule.base)} | ${DebugSymbol.fromAddress(S.address)}`);const e=Instruction.parse(S.address);logd(`[${_}] \t${e.address} ${e}`)})),newLine())}))};var _=!1;globalThis.nopSysCall=(_="",e=!1)=>{findSvcInstructions(_),S.forEach((S=>{Memory.patchCode(S,4,(S=>{const _=Instruction.parse(S.sub(4)),t=Number(_.operands.find((S=>"imm"==S.type))?.value);"arm64"==Process.arch?(t==SYSCALL.SYS_exit||t==SYSCALL.SYS_ptrace||e)&&new Arm64Writer(S).putNop():Interceptor.attach(_.address,{onEnter(_){logd(`Called SVC -> ${SYSCALL[t]} @ ${S}`),new Arm64Writer(S).putNop()}})}))}))},globalThis.modTargets=()=>{_||(_=!0,Process.setExceptionHandler((_=>{if(S.includes(_.address)){loge(`Got Ins Err -> ${_.address}`);let S=_.address.readU32();return _.address.writeU32(ptr(S).xor(S).toUInt32()),!0}return!1}))),logw(`targetPointers -> ${S.length}`),S.forEach((S=>{Memory.patchCode(S,4,(S=>{let _=S.readU32();S.writeU32(ptr(_).xor(_).toUInt32())}))}))};export var SYSCALL;!function(S){S[S.SYS_syscall=0]="SYS_syscall",S[S.SYS_exit=1]="SYS_exit",S[S.SYS_fork=2]="SYS_fork",S[S.SYS_read=3]="SYS_read",S[S.SYS_write=4]="SYS_write",S[S.SYS_open=5]="SYS_open",S[S.SYS_close=6]="SYS_close",S[S.SYS_wait4=7]="SYS_wait4",S[S.SYS_link=9]="SYS_link",S[S.SYS_unlink=10]="SYS_unlink",S[S.SYS_chdir=12]="SYS_chdir",S[S.SYS_fchdir=13]="SYS_fchdir",S[S.SYS_mknod=14]="SYS_mknod",S[S.SYS_chmod=15]="SYS_chmod",S[S.SYS_chown=16]="SYS_chown",S[S.SYS_getfsstat=18]="SYS_getfsstat",S[S.SYS_getpid=20]="SYS_getpid",S[S.SYS_setuid=23]="SYS_setuid",S[S.SYS_getuid=24]="SYS_getuid",S[S.SYS_geteuid=25]="SYS_geteuid",S[S.SYS_ptrace=26]="SYS_ptrace",S[S.SYS_recvmsg=27]="SYS_recvmsg",S[S.SYS_sendmsg=28]="SYS_sendmsg",S[S.SYS_recvfrom=29]="SYS_recvfrom",S[S.SYS_accept=30]="SYS_accept",S[S.SYS_getpeername=31]="SYS_getpeername",S[S.SYS_getsockname=32]="SYS_getsockname",S[S.SYS_access=33]="SYS_access",S[S.SYS_chflags=34]="SYS_chflags",S[S.SYS_fchflags=35]="SYS_fchflags",S[S.SYS_sync=36]="SYS_sync",S[S.SYS_kill=37]="SYS_kill",S[S.SYS_getppid=39]="SYS_getppid",S[S.SYS_dup=41]="SYS_dup",S[S.SYS_pipe=42]="SYS_pipe",S[S.SYS_getegid=43]="SYS_getegid",S[S.SYS_sigaction=46]="SYS_sigaction",S[S.SYS_getgid=47]="SYS_getgid",S[S.SYS_sigprocmask=48]="SYS_sigprocmask",S[S.SYS_getlogin=49]="SYS_getlogin",S[S.SYS_setlogin=50]="SYS_setlogin",S[S.SYS_acct=51]="SYS_acct",S[S.SYS_sigpending=52]="SYS_sigpending",S[S.SYS_sigaltstack=53]="SYS_sigaltstack",S[S.SYS_ioctl=54]="SYS_ioctl",S[S.SYS_reboot=55]="SYS_reboot",S[S.SYS_revoke=56]="SYS_revoke",S[S.SYS_symlink=57]="SYS_symlink",S[S.SYS_readlink=58]="SYS_readlink",S[S.SYS_execve=59]="SYS_execve",S[S.SYS_umask=60]="SYS_umask",S[S.SYS_chroot=61]="SYS_chroot",S[S.SYS_invalid=63]="SYS_invalid",S[S.SYS_msync=65]="SYS_msync",S[S.SYS_vfork=66]="SYS_vfork",S[S.SYS_munmap=73]="SYS_munmap",S[S.SYS_mprotect=74]="SYS_mprotect",S[S.SYS_madvise=75]="SYS_madvise",S[S.SYS_mincore=78]="SYS_mincore",S[S.SYS_getgroups=79]="SYS_getgroups",S[S.SYS_setgroups=80]="SYS_setgroups",S[S.SYS_getpgrp=81]="SYS_getpgrp",S[S.SYS_setpgid=82]="SYS_setpgid",S[S.SYS_setitimer=83]="SYS_setitimer",S[S.SYS_swapon=85]="SYS_swapon",S[S.SYS_getitimer=86]="SYS_getitimer",S[S.SYS_getdtablesize=89]="SYS_getdtablesize",S[S.SYS_dup2=90]="SYS_dup2",S[S.SYS_fcntl=92]="SYS_fcntl",S[S.SYS_select=93]="SYS_select",S[S.SYS_fsync=95]="SYS_fsync",S[S.SYS_setpriority=96]="SYS_setpriority",S[S.SYS_socket=97]="SYS_socket",S[S.SYS_connect=98]="SYS_connect",S[S.SYS_getpriority=100]="SYS_getpriority",S[S.SYS_bind=104]="SYS_bind",S[S.SYS_setsockopt=105]="SYS_setsockopt",S[S.SYS_listen=106]="SYS_listen",S[S.SYS_sigsuspend=111]="SYS_sigsuspend",S[S.SYS_gettimeofday=116]="SYS_gettimeofday",S[S.SYS_getrusage=117]="SYS_getrusage",S[S.SYS_getsockopt=118]="SYS_getsockopt",S[S.SYS_readv=120]="SYS_readv",S[S.SYS_writev=121]="SYS_writev",S[S.SYS_settimeofday=122]="SYS_settimeofday",S[S.SYS_fchown=123]="SYS_fchown",S[S.SYS_fchmod=124]="SYS_fchmod",S[S.SYS_setreuid=126]="SYS_setreuid",S[S.SYS_setregid=127]="SYS_setregid",S[S.SYS_rename=128]="SYS_rename",S[S.SYS_flock=131]="SYS_flock",S[S.SYS_mkfifo=132]="SYS_mkfifo",S[S.SYS_sendto=133]="SYS_sendto",S[S.SYS_shutdown=134]="SYS_shutdown",S[S.SYS_socketpair=135]="SYS_socketpair",S[S.SYS_mkdir=136]="SYS_mkdir",S[S.SYS_rmdir=137]="SYS_rmdir",S[S.SYS_utimes=138]="SYS_utimes",S[S.SYS_futimes=139]="SYS_futimes",S[S.SYS_adjtime=140]="SYS_adjtime",S[S.SYS_gethostuuid=142]="SYS_gethostuuid",S[S.SYS_setsid=147]="SYS_setsid",S[S.SYS_getpgid=151]="SYS_getpgid",S[S.SYS_setprivexec=152]="SYS_setprivexec",S[S.SYS_pread=153]="SYS_pread",S[S.SYS_pwrite=154]="SYS_pwrite",S[S.SYS_nfssvc=155]="SYS_nfssvc",S[S.SYS_statfs=157]="SYS_statfs",S[S.SYS_fstatfs=158]="SYS_fstatfs",S[S.SYS_unmount=159]="SYS_unmount",S[S.SYS_getfh=161]="SYS_getfh",S[S.SYS_quotactl=165]="SYS_quotactl",S[S.SYS_mount=167]="SYS_mount",S[S.SYS_csops=169]="SYS_csops",S[S.SYS_csops_audittoken=170]="SYS_csops_audittoken",S[S.SYS_waitid=173]="SYS_waitid",S[S.SYS_kdebug_typefilter=177]="SYS_kdebug_typefilter",S[S.SYS_kdebug_trace_string=178]="SYS_kdebug_trace_string",S[S.SYS_kdebug_trace64=179]="SYS_kdebug_trace64",S[S.SYS_kdebug_trace=180]="SYS_kdebug_trace",S[S.SYS_setgid=181]="SYS_setgid",S[S.SYS_setegid=182]="SYS_setegid",S[S.SYS_seteuid=183]="SYS_seteuid",S[S.SYS_sigreturn=184]="SYS_sigreturn",S[S.SYS_thread_selfcounts=186]="SYS_thread_selfcounts",S[S.SYS_fdatasync=187]="SYS_fdatasync",S[S.SYS_stat=188]="SYS_stat",S[S.SYS_fstat=189]="SYS_fstat",S[S.SYS_lstat=190]="SYS_lstat",S[S.SYS_pathconf=191]="SYS_pathconf",S[S.SYS_fpathconf=192]="SYS_fpathconf",S[S.SYS_getrlimit=194]="SYS_getrlimit",S[S.SYS_setrlimit=195]="SYS_setrlimit",S[S.SYS_getdirentries=196]="SYS_getdirentries",S[S.SYS_mmap=197]="SYS_mmap",S[S.SYS_lseek=199]="SYS_lseek",S[S.SYS_truncate=200]="SYS_truncate",S[S.SYS_ftruncate=201]="SYS_ftruncate",S[S.SYS_sysctl=202]="SYS_sysctl",S[S.SYS_mlock=203]="SYS_mlock",S[S.SYS_munlock=204]="SYS_munlock",S[S.SYS_undelete=205]="SYS_undelete",S[S.SYS_open_dprotected_np=216]="SYS_open_dprotected_np",S[S.SYS_fsgetpath_ext=217]="SYS_fsgetpath_ext",S[S.SYS_getattrlist=220]="SYS_getattrlist",S[S.SYS_setattrlist=221]="SYS_setattrlist",S[S.SYS_getdirentriesattr=222]="SYS_getdirentriesattr",S[S.SYS_exchangedata=223]="SYS_exchangedata",S[S.SYS_searchfs=225]="SYS_searchfs",S[S.SYS_delete=226]="SYS_delete",S[S.SYS_copyfile=227]="SYS_copyfile",S[S.SYS_fgetattrlist=228]="SYS_fgetattrlist",S[S.SYS_fsetattrlist=229]="SYS_fsetattrlist",S[S.SYS_poll=230]="SYS_poll",S[S.SYS_watchevent=231]="SYS_watchevent",S[S.SYS_waitevent=232]="SYS_waitevent",S[S.SYS_modwatch=233]="SYS_modwatch",S[S.SYS_getxattr=234]="SYS_getxattr",S[S.SYS_fgetxattr=235]="SYS_fgetxattr",S[S.SYS_setxattr=236]="SYS_setxattr",S[S.SYS_fsetxattr=237]="SYS_fsetxattr",S[S.SYS_removexattr=238]="SYS_removexattr",S[S.SYS_fremovexattr=239]="SYS_fremovexattr",S[S.SYS_listxattr=240]="SYS_listxattr",S[S.SYS_flistxattr=241]="SYS_flistxattr",S[S.SYS_fsctl=242]="SYS_fsctl",S[S.SYS_initgroups=243]="SYS_initgroups",S[S.SYS_posix_spawn=244]="SYS_posix_spawn",S[S.SYS_ffsctl=245]="SYS_ffsctl",S[S.SYS_nfsclnt=247]="SYS_nfsclnt",S[S.SYS_fhopen=248]="SYS_fhopen",S[S.SYS_minherit=250]="SYS_minherit",S[S.SYS_semsys=251]="SYS_semsys",S[S.SYS_msgsys=252]="SYS_msgsys",S[S.SYS_shmsys=253]="SYS_shmsys",S[S.SYS_semctl=254]="SYS_semctl",S[S.SYS_semget=255]="SYS_semget",S[S.SYS_semop=256]="SYS_semop",S[S.SYS_msgctl=258]="SYS_msgctl",S[S.SYS_msgget=259]="SYS_msgget",S[S.SYS_msgsnd=260]="SYS_msgsnd",S[S.SYS_msgrcv=261]="SYS_msgrcv",S[S.SYS_shmat=262]="SYS_shmat",S[S.SYS_shmctl=263]="SYS_shmctl",S[S.SYS_shmdt=264]="SYS_shmdt",S[S.SYS_shmget=265]="SYS_shmget",S[S.SYS_shm_open=266]="SYS_shm_open",S[S.SYS_shm_unlink=267]="SYS_shm_unlink",S[S.SYS_sem_open=268]="SYS_sem_open",S[S.SYS_sem_close=269]="SYS_sem_close",S[S.SYS_sem_unlink=270]="SYS_sem_unlink",S[S.SYS_sem_wait=271]="SYS_sem_wait",S[S.SYS_sem_trywait=272]="SYS_sem_trywait",S[S.SYS_sem_post=273]="SYS_sem_post",S[S.SYS_sysctlbyname=274]="SYS_sysctlbyname",S[S.SYS_open_extended=277]="SYS_open_extended",S[S.SYS_umask_extended=278]="SYS_umask_extended",S[S.SYS_stat_extended=279]="SYS_stat_extended",S[S.SYS_lstat_extended=280]="SYS_lstat_extended",S[S.SYS_fstat_extended=281]="SYS_fstat_extended",S[S.SYS_chmod_extended=282]="SYS_chmod_extended",S[S.SYS_fchmod_extended=283]="SYS_fchmod_extended",S[S.SYS_access_extended=284]="SYS_access_extended",S[S.SYS_settid=285]="SYS_settid",S[S.SYS_gettid=286]="SYS_gettid",S[S.SYS_setsgroups=287]="SYS_setsgroups",S[S.SYS_getsgroups=288]="SYS_getsgroups",S[S.SYS_setwgroups=289]="SYS_setwgroups",S[S.SYS_getwgroups=290]="SYS_getwgroups",S[S.SYS_mkfifo_extended=291]="SYS_mkfifo_extended",S[S.SYS_mkdir_extended=292]="SYS_mkdir_extended",S[S.SYS_identitysvc=293]="SYS_identitysvc",S[S.SYS_shared_region_check_np=294]="SYS_shared_region_check_np",S[S.SYS_vm_pressure_monitor=296]="SYS_vm_pressure_monitor",S[S.SYS_psynch_rw_longrdlock=297]="SYS_psynch_rw_longrdlock",S[S.SYS_psynch_rw_yieldwrlock=298]="SYS_psynch_rw_yieldwrlock",S[S.SYS_psynch_rw_downgrade=299]="SYS_psynch_rw_downgrade",S[S.SYS_psynch_rw_upgrade=300]="SYS_psynch_rw_upgrade",S[S.SYS_psynch_mutexwait=301]="SYS_psynch_mutexwait",S[S.SYS_psynch_mutexdrop=302]="SYS_psynch_mutexdrop",S[S.SYS_psynch_cvbroad=303]="SYS_psynch_cvbroad",S[S.SYS_psynch_cvsignal=304]="SYS_psynch_cvsignal",S[S.SYS_psynch_cvwait=305]="SYS_psynch_cvwait",S[S.SYS_psynch_rw_rdlock=306]="SYS_psynch_rw_rdlock",S[S.SYS_psynch_rw_wrlock=307]="SYS_psynch_rw_wrlock",S[S.SYS_psynch_rw_unlock=308]="SYS_psynch_rw_unlock",S[S.SYS_psynch_rw_unlock2=309]="SYS_psynch_rw_unlock2",S[S.SYS_getsid=310]="SYS_getsid",S[S.SYS_settid_with_pid=311]="SYS_settid_with_pid",S[S.SYS_psynch_cvclrprepost=312]="SYS_psynch_cvclrprepost",S[S.SYS_aio_fsync=313]="SYS_aio_fsync",S[S.SYS_aio_return=314]="SYS_aio_return",S[S.SYS_aio_suspend=315]="SYS_aio_suspend",S[S.SYS_aio_cancel=316]="SYS_aio_cancel",S[S.SYS_aio_error=317]="SYS_aio_error",S[S.SYS_aio_read=318]="SYS_aio_read",S[S.SYS_aio_write=319]="SYS_aio_write",S[S.SYS_lio_listio=320]="SYS_lio_listio",S[S.SYS_iopolicysys=322]="SYS_iopolicysys",S[S.SYS_process_policy=323]="SYS_process_policy",S[S.SYS_mlockall=324]="SYS_mlockall",S[S.SYS_munlockall=325]="SYS_munlockall",S[S.SYS_issetugid=327]="SYS_issetugid",S[S.SYS___pthread_kill=328]="SYS___pthread_kill",S[S.SYS___pthread_sigmask=329]="SYS___pthread_sigmask",S[S.SYS___sigwait=330]="SYS___sigwait",S[S.SYS___disable_threadsignal=331]="SYS___disable_threadsignal",S[S.SYS___pthread_markcancel=332]="SYS___pthread_markcancel",S[S.SYS___pthread_canceled=333]="SYS___pthread_canceled",S[S.SYS___semwait_signal=334]="SYS___semwait_signal",S[S.SYS_proc_info=336]="SYS_proc_info",S[S.SYS_sendfile=337]="SYS_sendfile",S[S.SYS_stat64=338]="SYS_stat64",S[S.SYS_fstat64=339]="SYS_fstat64",S[S.SYS_lstat64=340]="SYS_lstat64",S[S.SYS_stat64_extended=341]="SYS_stat64_extended",S[S.SYS_lstat64_extended=342]="SYS_lstat64_extended",S[S.SYS_fstat64_extended=343]="SYS_fstat64_extended",S[S.SYS_getdirentries64=344]="SYS_getdirentries64",S[S.SYS_statfs64=345]="SYS_statfs64",S[S.SYS_fstatfs64=346]="SYS_fstatfs64",S[S.SYS_getfsstat64=347]="SYS_getfsstat64",S[S.SYS___pthread_chdir=348]="SYS___pthread_chdir",S[S.SYS___pthread_fchdir=349]="SYS___pthread_fchdir",S[S.SYS_audit=350]="SYS_audit",S[S.SYS_auditon=351]="SYS_auditon",S[S.SYS_getauid=353]="SYS_getauid",S[S.SYS_setauid=354]="SYS_setauid",S[S.SYS_getaudit_addr=357]="SYS_getaudit_addr",S[S.SYS_setaudit_addr=358]="SYS_setaudit_addr",S[S.SYS_auditctl=359]="SYS_auditctl",S[S.SYS_bsdthread_create=360]="SYS_bsdthread_create",S[S.SYS_bsdthread_terminate=361]="SYS_bsdthread_terminate",S[S.SYS_kqueue=362]="SYS_kqueue",S[S.SYS_kevent=363]="SYS_kevent",S[S.SYS_lchown=364]="SYS_lchown",S[S.SYS_bsdthread_register=366]="SYS_bsdthread_register",S[S.SYS_workq_open=367]="SYS_workq_open",S[S.SYS_workq_kernreturn=368]="SYS_workq_kernreturn",S[S.SYS_kevent64=369]="SYS_kevent64",S[S.SYS___old_semwait_signal=370]="SYS___old_semwait_signal",S[S.SYS___old_semwait_signal_nocancel=371]="SYS___old_semwait_signal_nocancel",S[S.SYS_thread_selfid=372]="SYS_thread_selfid",S[S.SYS_ledger=373]="SYS_ledger",S[S.SYS_kevent_qos=374]="SYS_kevent_qos",S[S.SYS_kevent_id=375]="SYS_kevent_id",S[S.SYS___mac_execve=380]="SYS___mac_execve",S[S.SYS___mac_syscall=381]="SYS___mac_syscall",S[S.SYS___mac_get_file=382]="SYS___mac_get_file",S[S.SYS___mac_set_file=383]="SYS___mac_set_file",S[S.SYS___mac_get_link=384]="SYS___mac_get_link",S[S.SYS___mac_set_link=385]="SYS___mac_set_link",S[S.SYS___mac_get_proc=386]="SYS___mac_get_proc",S[S.SYS___mac_set_proc=387]="SYS___mac_set_proc",S[S.SYS___mac_get_fd=388]="SYS___mac_get_fd",S[S.SYS___mac_set_fd=389]="SYS___mac_set_fd",S[S.SYS___mac_get_pid=390]="SYS___mac_get_pid",S[S.SYS_pselect=394]="SYS_pselect",S[S.SYS_pselect_nocancel=395]="SYS_pselect_nocancel",S[S.SYS_read_nocancel=396]="SYS_read_nocancel",S[S.SYS_write_nocancel=397]="SYS_write_nocancel",S[S.SYS_open_nocancel=398]="SYS_open_nocancel",S[S.SYS_close_nocancel=399]="SYS_close_nocancel",S[S.SYS_wait4_nocancel=400]="SYS_wait4_nocancel",S[S.SYS_recvmsg_nocancel=401]="SYS_recvmsg_nocancel",S[S.SYS_sendmsg_nocancel=402]="SYS_sendmsg_nocancel",S[S.SYS_recvfrom_nocancel=403]="SYS_recvfrom_nocancel",S[S.SYS_accept_nocancel=404]="SYS_accept_nocancel",S[S.SYS_msync_nocancel=405]="SYS_msync_nocancel",S[S.SYS_fcntl_nocancel=406]="SYS_fcntl_nocancel",S[S.SYS_select_nocancel=407]="SYS_select_nocancel",S[S.SYS_fsync_nocancel=408]="SYS_fsync_nocancel",S[S.SYS_connect_nocancel=409]="SYS_connect_nocancel",S[S.SYS_sigsuspend_nocancel=410]="SYS_sigsuspend_nocancel",S[S.SYS_readv_nocancel=411]="SYS_readv_nocancel",S[S.SYS_writev_nocancel=412]="SYS_writev_nocancel",S[S.SYS_sendto_nocancel=413]="SYS_sendto_nocancel",S[S.SYS_pread_nocancel=414]="SYS_pread_nocancel",S[S.SYS_pwrite_nocancel=415]="SYS_pwrite_nocancel",S[S.SYS_waitid_nocancel=416]="SYS_waitid_nocancel",S[S.SYS_poll_nocancel=417]="SYS_poll_nocancel",S[S.SYS_msgsnd_nocancel=418]="SYS_msgsnd_nocancel",S[S.SYS_msgrcv_nocancel=419]="SYS_msgrcv_nocancel",S[S.SYS_sem_wait_nocancel=420]="SYS_sem_wait_nocancel",S[S.SYS_aio_suspend_nocancel=421]="SYS_aio_suspend_nocancel",S[S.SYS___sigwait_nocancel=422]="SYS___sigwait_nocancel",S[S.SYS___semwait_signal_nocancel=423]="SYS___semwait_signal_nocancel",S[S.SYS___mac_mount=424]="SYS___mac_mount",S[S.SYS___mac_get_mount=425]="SYS___mac_get_mount",S[S.SYS___mac_getfsstat=426]="SYS___mac_getfsstat",S[S.SYS_fsgetpath=427]="SYS_fsgetpath",S[S.SYS_audit_session_self=428]="SYS_audit_session_self",S[S.SYS_audit_session_join=429]="SYS_audit_session_join",S[S.SYS_fileport_makeport=430]="SYS_fileport_makeport",S[S.SYS_fileport_makefd=431]="SYS_fileport_makefd",S[S.SYS_audit_session_port=432]="SYS_audit_session_port",S[S.SYS_pid_suspend=433]="SYS_pid_suspend",S[S.SYS_pid_resume=434]="SYS_pid_resume",S[S.SYS_pid_hibernate=435]="SYS_pid_hibernate",S[S.SYS_pid_shutdown_sockets=436]="SYS_pid_shutdown_sockets",S[S.SYS_shared_region_map_and_slide_np=438]="SYS_shared_region_map_and_slide_np",S[S.SYS_kas_info=439]="SYS_kas_info",S[S.SYS_memorystatus_control=440]="SYS_memorystatus_control",S[S.SYS_guarded_open_np=441]="SYS_guarded_open_np",S[S.SYS_guarded_close_np=442]="SYS_guarded_close_np",S[S.SYS_guarded_kqueue_np=443]="SYS_guarded_kqueue_np",S[S.SYS_change_fdguard_np=444]="SYS_change_fdguard_np",S[S.SYS_usrctl=445]="SYS_usrctl",S[S.SYS_proc_rlimit_control=446]="SYS_proc_rlimit_control",S[S.SYS_connectx=447]="SYS_connectx",S[S.SYS_disconnectx=448]="SYS_disconnectx",S[S.SYS_peeloff=449]="SYS_peeloff",S[S.SYS_socket_delegate=450]="SYS_socket_delegate",S[S.SYS_telemetry=451]="SYS_telemetry",S[S.SYS_proc_uuid_policy=452]="SYS_proc_uuid_policy",S[S.SYS_memorystatus_get_level=453]="SYS_memorystatus_get_level",S[S.SYS_system_override=454]="SYS_system_override",S[S.SYS_vfs_purge=455]="SYS_vfs_purge",S[S.SYS_sfi_ctl=456]="SYS_sfi_ctl",S[S.SYS_sfi_pidctl=457]="SYS_sfi_pidctl",S[S.SYS_coalition=458]="SYS_coalition",S[S.SYS_coalition_info=459]="SYS_coalition_info",S[S.SYS_necp_match_policy=460]="SYS_necp_match_policy",S[S.SYS_getattrlistbulk=461]="SYS_getattrlistbulk",S[S.SYS_clonefileat=462]="SYS_clonefileat",S[S.SYS_openat=463]="SYS_openat",S[S.SYS_openat_nocancel=464]="SYS_openat_nocancel",S[S.SYS_renameat=465]="SYS_renameat",S[S.SYS_faccessat=466]="SYS_faccessat",S[S.SYS_fchmodat=467]="SYS_fchmodat",S[S.SYS_fchownat=468]="SYS_fchownat",S[S.SYS_fstatat=469]="SYS_fstatat",S[S.SYS_fstatat64=470]="SYS_fstatat64",S[S.SYS_linkat=471]="SYS_linkat",S[S.SYS_unlinkat=472]="SYS_unlinkat",S[S.SYS_readlinkat=473]="SYS_readlinkat",S[S.SYS_symlinkat=474]="SYS_symlinkat",S[S.SYS_mkdirat=475]="SYS_mkdirat",S[S.SYS_getattrlistat=476]="SYS_getattrlistat",S[S.SYS_proc_trace_log=477]="SYS_proc_trace_log",S[S.SYS_bsdthread_ctl=478]="SYS_bsdthread_ctl",S[S.SYS_openbyid_np=479]="SYS_openbyid_np",S[S.SYS_recvmsg_x=480]="SYS_recvmsg_x",S[S.SYS_sendmsg_x=481]="SYS_sendmsg_x",S[S.SYS_thread_selfusage=482]="SYS_thread_selfusage",S[S.SYS_csrctl=483]="SYS_csrctl",S[S.SYS_guarded_open_dprotected_np=484]="SYS_guarded_open_dprotected_np",S[S.SYS_guarded_write_np=485]="SYS_guarded_write_np",S[S.SYS_guarded_pwrite_np=486]="SYS_guarded_pwrite_np",S[S.SYS_guarded_writev_np=487]="SYS_guarded_writev_np",S[S.SYS_renameatx_np=488]="SYS_renameatx_np",S[S.SYS_mremap_encrypted=489]="SYS_mremap_encrypted",S[S.SYS_netagent_trigger=490]="SYS_netagent_trigger",S[S.SYS_stack_snapshot_with_config=491]="SYS_stack_snapshot_with_config",S[S.SYS_microstackshot=492]="SYS_microstackshot",S[S.SYS_grab_pgo_data=493]="SYS_grab_pgo_data",S[S.SYS_persona=494]="SYS_persona",S[S.SYS_work_interval_ctl=499]="SYS_work_interval_ctl",S[S.SYS_getentropy=500]="SYS_getentropy",S[S.SYS_necp_open=501]="SYS_necp_open",S[S.SYS_necp_client_action=502]="SYS_necp_client_action",S[S.SYS___nexus_open=503]="SYS___nexus_open",S[S.SYS___nexus_register=504]="SYS___nexus_register",S[S.SYS___nexus_deregister=505]="SYS___nexus_deregister",S[S.SYS___nexus_create=506]="SYS___nexus_create",S[S.SYS___nexus_destroy=507]="SYS___nexus_destroy",S[S.SYS___nexus_get_opt=508]="SYS___nexus_get_opt",S[S.SYS___nexus_set_opt=509]="SYS___nexus_set_opt",S[S.SYS___channel_open=510]="SYS___channel_open",S[S.SYS___channel_get_info=511]="SYS___channel_get_info",S[S.SYS___channel_sync=512]="SYS___channel_sync",S[S.SYS___channel_get_opt=513]="SYS___channel_get_opt",S[S.SYS___channel_set_opt=514]="SYS___channel_set_opt",S[S.SYS_ulock_wait=515]="SYS_ulock_wait",S[S.SYS_ulock_wake=516]="SYS_ulock_wake",S[S.SYS_fclonefileat=517]="SYS_fclonefileat",S[S.SYS_fs_snapshot=518]="SYS_fs_snapshot",S[S.SYS_terminate_with_payload=520]="SYS_terminate_with_payload",S[S.SYS_abort_with_payload=521]="SYS_abort_with_payload",S[S.SYS_necp_session_open=522]="SYS_necp_session_open",S[S.SYS_necp_session_action=523]="SYS_necp_session_action",S[S.SYS_setattrlistat=524]="SYS_setattrlistat",S[S.SYS_net_qos_guideline=525]="SYS_net_qos_guideline",S[S.SYS_fmount=526]="SYS_fmount",S[S.SYS_ntp_adjtime=527]="SYS_ntp_adjtime",S[S.SYS_ntp_gettime=528]="SYS_ntp_gettime",S[S.SYS_os_fault_with_payload=529]="SYS_os_fault_with_payload",S[S.SYS_kqueue_workloop_ctl=530]="SYS_kqueue_workloop_ctl",S[S.SYS___mach_bridge_remote_time=531]="SYS___mach_bridge_remote_time",S[S.SYS_coalition_ledger=532]="SYS_coalition_ledger",S[S.SYS_log_data=533]="SYS_log_data",S[S.SYS_memorystatus_available_memory=534]="SYS_memorystatus_available_memory",S[S.SYS_MAXSYSCALL=535]="SYS_MAXSYSCALL"}(SYSCALL||(SYSCALL={}));
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/memory/","sources":["include.ts"],"mappings":"MAAO","ignoreList":[]}
âœ„
import"./findsvc.js";
âœ„
{"version":3,"file":"include.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/service/","sources":["include.ts"],"mappings":"MAAO","ignoreList":[]}
âœ„
import"./main.js";
âœ„
{"version":3,"file":"main.js","names":["setImmediate"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/plugin/service/","sources":["main.ts"],"mappings":"AAEAA,cAAa,KAwEgE","ignoreList":[]}
âœ„
setImmediate((()=>{}));
âœ„
{"version":3,"file":"types.js","names":[],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":[],"mappings":"","ignoreList":[]}
âœ„
export{};
âœ„
{"version":3,"file":"utils.js","names":["NSUTF8StringEncoding","ProcessDispTask","constructor","max","refreshTime","this","_maxProgress","_refreshTime","_currentProgress","_displayTitile","_processRuning","start","setMax","_taskID","setInterval","stop","console","log","warn","clearInterval","update","progress","globalThis","clear","hex","ptr","len","mPtr","NULL","startsWith","NativePointer","isNull","Error","hexdump","length","header","ansi","dumpUI","logd","ObjC","classes","UIWindow","keyWindow","recursiveDescription","toString","checkPointer","throwErr","trim","handle","DebugSymbol","fromName","address","parseInt","Object","allocOCString","str","undefined","allocCString","Memory","allocUtf8String","debugLog","call","args","target","logw","argsStr","map","arg","join","func","eval","item","error","callOC","objPtr","funcName","callOcOnMain","schedule","mainQueue","ret","bytesToUTF8","data","hasOwnProperty","s","NSString","alloc","initWithBytes_length_encoding_","bytes","UTF8String","passValueKey","lfs","obj","$kind","showSuperClasses","$clonedIvars","vars","$ivars","index","k","v","$className","$class","logz","map_attach_listener","Map","attachNative","mOnEnter","mOnLeave","needRecord","passValue","set","org","src","enter","leave","time","Date","Listener","Interceptor","attach","onEnter","context","onLeave","retval","String","detachAll","key","listener","get","detach","delete","arr_nop_addr","Array","replaceFunction","callBack","TYPENOP","indexOf","push","revert","srcFunc","NativeFunction","replace","NativeCallback","arg0","arg1","arg2","arg3","nopFunction","cancelNop","i","splice","cancelAllNopedFunction","forEach","addr","stk","selectorAsString","Stalker","follow","Process","getCurrentThreadId","events","exec","onReceive","bbs","parse","stringify","annotate","flat","fromAddress","unfollow","flush","isObjcInstance","readPointer","nameToMethod","method","endsWith","parts","slice","split","className","classMethod","addressToMethod","name","showAsm","next","newLine","ins","Instruction","mnemonic","opStr","asOcObj","demangleName","expName","demangleAddress","Module","findExportByName","demangle","mangledName","outputBuffer","status","pageSize","result","readInt","resultStr","readUtf8String","getSym","filterName","mdName","enumerateModules","flatMap","module","enumerateSymbols","filter","includes","findModuleByName","findSym","imageName","onlyFunction","iteratorName","md","syms","filterSyms","msd","demangeName","rva","sub","base","type","path","sleep","sec","_getAddr__mod_init_func","sectionName","moduleName","mainModule","getModuleByName","enumerateSections","find","HK_TYPE","d","A","n","nn","nnn","D"],"sourceRoot":"/Users/lzy/git_projects/IOSUtils/agent/","sources":["utils.ts"],"mappings":"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","ignoreList":[]}
âœ„
import{NSUTF8StringEncoding}from"./constants.js";import"./types.js";export class ProcessDispTask{constructor(e=100,t=1e3){this._maxProgress=100,this._refreshTime=200,this._currentProgress=0,this._displayTitile="Progress: ",this._processRuning=!1,this._maxProgress=e,this._refreshTime=t,this._currentProgress=0,this.start()}setMax(e){this._maxProgress=e}start(){this._processRuning=!0,this._taskID=setInterval((()=>{this._currentProgress>=this._maxProgress&&this.stop(),this._processRuning&&(console.log("c"),console.warn(`${this._displayTitile} ${100*this._currentProgress/this._maxProgress}%\r`))}),this._refreshTime)}stop(){clearInterval(this._taskID),this._processRuning=!1,console.log(`${this._displayTitile} ${100*this._currentProgress/this._maxProgress}%`)}update(e){this._currentProgress=e}}globalThis.ProcessDispTask=ProcessDispTask,globalThis.clear=()=>console.log("c"),globalThis.hex=(e,t=64)=>{let n=NULL;if("string"==typeof e&&e.startsWith("0x")||"number"==typeof e?n=new NativePointer(e):e instanceof NativePointer&&(n=e),n.isNull())throw new Error("ptr is null");console.log(hexdump(n,{length:t,header:!0,ansi:!0}))},globalThis.dumpUI=()=>{logd(ObjC.classes.UIWindow.keyWindow().recursiveDescription().toString())},globalThis.checkPointer=(e,t=!0)=>{let n=NULL;if("string"==typeof e){if(!(e=e.trim()).startsWith("0x")){try{n=ObjC.classes[e].handle}catch{}try{n.isNull()&&(n=DebugSymbol.fromName(e).address)}catch{}if(n.isNull()){if(t)throw new Error(`Invalid pointer <- cannot find '${e}'`);return NULL}return n}n=new NativePointer(parseInt(e,16))}else"number"==typeof e?n=new NativePointer(e):e instanceof NativePointer?n=e:e instanceof ObjC.Object&&(n=e.handle);if(t&&n.isNull())throw new Error("Invalid pointer");return n},globalThis.allocOCString=e=>{if(null==e||0==e.length||null==e)throw new Error("Invalid string");return ObjC.classes.NSString["+ stringWithUTF8String:"](allocCString(e))},globalThis.allocCString=e=>{if(null==e||0==e.length||null==e)throw new Error("Invalid string");return Memory.allocUtf8String(e)};const debugLog=!1;globalThis.call=(ptr,...args)=>{try{const target=checkPointer(ptr);debugLog&&logw(`Called -> Address: ${target}${"string"==typeof ptr?` ${ptr}\t`:""} | Arguments [ ${args.length} ] -> ${args}`);const argsStr=args.map((e=>'"pointer"')).join(", "),func=eval(`new NativeFunction(new NativePointer(${target}), 'pointer', [ ${argsStr} ])`);if("function"!=typeof func)throw new Error("Error while Created NativeFunction");return func(...args.map((e=>checkPointer(e))))}catch(e){throw new Error(`Error during call: \n\t${e}`)}},globalThis.callOC=(e,t,...n)=>new ObjC.Object(checkPointer(e))[t](...n),globalThis.callOcOnMain=(e,t,...n)=>{ObjC.schedule(ObjC.mainQueue,(()=>{const r=callOC(e,t,...n);null!=r&&logd(`${r}`)}))};const bytesToUTF8=e=>{if(null===e)return"";if(!e.hasOwnProperty("bytes"))return e.toString();const t=ObjC.classes.NSString.alloc().initWithBytes_length_encoding_(e.bytes(),e.length(),NSUTF8StringEncoding);return t?t.UTF8String():""};var passValueKey;globalThis.lfs=(e,t=!1)=>{const n=checkPointer(e),r=new ObjC.Object(n);if("instance"!=r.$kind)throw new Error("ivars | can only parse instance");showSuperClasses(r.handle);const o={},s=r.$ivars;let l=0;for(const e in s)try{if(s.hasOwnProperty(e)){const n=s[e];if(o[e]=bytesToUTF8(n),t)continue;n instanceof ObjC.Object?(logd(`[${++l}] ${e}: | ObjC.Object <- ${n.$kind} of ${n.$className} @ ${n.$class.handle}`),logz(`\t${n.handle}`)):"object"==typeof n?(logd(`[${++l}] ${e}: | ${typeof n}`),logz(`\t${n}`)):(logd(`[${++l}] ${e}: | ${typeof n}`),logz(`\t${o[e]}`))}}catch(e){}if(t)return o},function(e){e.org="org",e.src="src",e.enter="enter",e.leave="leave",e.time="time"}(passValueKey||(passValueKey={}));var map_attach_listener=new Map;const attachNative=(e,t,n,r=!0)=>{if("number"==typeof e&&(e=ptr(e)),e instanceof NativePointer&&e.isNull())return;var o=new Map;o.set(passValueKey.org,e),o.set(passValueKey.src,e),o.set(passValueKey.enter,t),o.set(passValueKey.leave,n),o.set(passValueKey.time,new Date),e=checkPointer(e);let s=Interceptor.attach(e,{onEnter:function(e){null!=t&&t(e,this.context,o)},onLeave:function(e){null!=n&&n(e,this.context,o)}});r&&map_attach_listener.set(String(e),s)},detachAll=e=>{if("number"==typeof e&&(e=ptr(e)),null==e)map_attach_listener.clear(),Interceptor.detachAll();else{let t=String(checkPointer(e)),n=map_attach_listener.get(t);null!=n&&(n.detach(),map_attach_listener.delete(t))}};var arr_nop_addr=new Array;function replaceFunction(e,t,n=!0){e=checkPointer(e),-1==String(arr_nop_addr).indexOf(String(e))?arr_nop_addr.push(String(e)):Interceptor.revert(e);const r=new NativeFunction(e,"pointer",["pointer","pointer","pointer","pointer"]);Interceptor.replace(e,new NativeCallback(((o,s,l,a)=>{logw("\nCalled "+(n?"Replaced":"Nop")+" function ---\x3e "+e);const i=t(r,o,s,l,a);return i??ptr(0)}),"pointer",["pointer","pointer","pointer","pointer"]))}const nopFunction=e=>{"number"==typeof e&&(e=ptr(e)),null!=e&&replaceFunction(e,(()=>ptr(0)),!0)},cancelNop=e=>{e=checkPointer(e),Interceptor.revert(e);for(let t=0;t<arr_nop_addr.length;t++)String(arr_nop_addr[t])==String(e)&&(arr_nop_addr=arr_nop_addr.splice(arr_nop_addr[t],1))},cancelAllNopedFunction=()=>arr_nop_addr.forEach((e=>Interceptor.revert(e))),stk=e=>{Interceptor.attach(checkPointer(e),{onEnter:function(t){logw(`ENTER: ${e}\n\tINS=${new ObjC.Object(t[0])} SEL=${ObjC.selectorAsString(t[1])}`),logw(`\tARG2=${new ObjC.Object(t[2])} ARG3=${new ObjC.Object(t[3])} ... `),Stalker.follow(Process.getCurrentThreadId(),{events:{exec:!0},onReceive:function(e){const t=Stalker.parse(e,{stringify:!1,annotate:!1});logd("â†“ Stalker trace â†“\n"),logd(t.flat().map((e=>DebugSymbol.fromAddress(ptr(e)))).join("\n"))}})},onLeave:function(e){Stalker.unfollow(),Stalker.flush()}})};globalThis.isObjcInstance=e=>{if(null==e||e.isNull())return NULL;try{return call("object_getClass",e).readPointer()}catch(e){return NULL}},globalThis.nameToMethod=e=>{if("["==e[1]&&e.endsWith("]")){const t=e.slice(2,-1).split(" ");if(2!=t.length)throw new Error("Invalid format, there should be exactly one space.");const n=t[0],r=`${e[0]} ${t[1]}`;return ObjC.classes[n][r]}throw new Error("Invalid format, should start with '+[' / '-[' and end with ']'")},globalThis.addressToMethod=e=>nameToMethod(DebugSymbol.fromAddress(e).name),globalThis.showAsm=(e,t=32)=>{let n=checkPointer(e);for(newLine();t-- >0;)try{const e=Instruction.parse(n);logd(`${e.address} ${e.mnemonic} ${e.opStr}`),n=e.next}catch(e){}newLine()},globalThis.asOcObj=e=>new ObjC.Object(ptr(e)),globalThis.demangleName=e=>{const t=Module.findExportByName(null,"__cxa_demangle");if(null==t)throw Error("can not find export function -> __cxa_demangle");const n=new NativeFunction(t,"pointer",["pointer","pointer","pointer","pointer"]),r=Memory.allocUtf8String(e),o=NULL,s=NULL,l=Memory.alloc(Process.pageSize),a=n(r,o,s,l);if(0===l.readInt()){let t=a.readUtf8String();return null==t||t==e?"":t}return""},globalThis.getSym=(e,t)=>{if(null==t)return Process.enumerateModules().flatMap((e=>e.enumerateSymbols())).filter((t=>t.name.includes(e)||demangleName(t.name).includes(e)));{const n=Process.findModuleByName(t);return n?n.enumerateSymbols().filter((t=>t.name.includes(e)||demangleName(t.name).includes(e))):void logw(`Module '${t}' not found...`)}},globalThis.findSym=(e,t="",n=!1)=>{if(null==e)throw new Error("filterName can not be null ...");function r(t){if(null==t)throw new Error("Module can not be null ...");const r=t.enumerateSymbols(),o=r.map((e=>({msd:e,demangeName:demangleName(e.name),rva:e.address.sub(t.base)}))).filter((t=>t.demangeName.includes(e)||t.msd.name.includes(e))).filter((e=>!n||"function"==e.msd.type)).filter((e=>!e.msd.address.isNull()));0!=o.length&&(logw(`Found { ${o.length} / ${r.length} } in '${t.path}'\n`),o.forEach(((e,t)=>{logd(`[${t}] \t${e.msd.address} -> \t${e.msd.name}`),0!=e.demangeName.length&&logz(`\t\t\t${e.demangeName} | ${e.rva}`)})),newLine())}newLine(),null!=t&&t.length>0?t.includes("*")?Process.enumerateModules().filter((e=>e.name.includes(t.replace("*","")))).forEach((e=>r(e))):r(Process.findModuleByName(t)):null!=t&&""!=t?r(Process.findModuleByName(t)):Process.enumerateModules().forEach(r)},globalThis.sleep=e=>new NativeFunction(DebugSymbol.fromName("sleep").address,"pointer",["int"])(e);const _getAddr__mod_init_func=(e="__mod_init_func",t=Process.mainModule.name)=>Process.getModuleByName(t).enumerateSections().find((t=>t.name.includes(e)));export var HK_TYPE;!function(e){e[e.FRIDA_ATTACH=0]="FRIDA_ATTACH",e[e.FRIDA_REP=1]="FRIDA_REP",e[e.OBJC_REP=2]="OBJC_REP"}(HK_TYPE||(HK_TYPE={})),globalThis.d=detachAll,globalThis.A=attachNative,globalThis.n=nopFunction,globalThis.nn=cancelNop,globalThis.nnn=cancelAllNopedFunction,globalThis.D=()=>{d(),nnn()},globalThis.stk=stk;